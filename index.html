<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>2025 ÌïôÍµêÌèâÍ∞Ä Î∂ÑÏÑù ÎåÄÏãúÎ≥¥Îìú - ÏõêÎ¨µÍ≥†Îì±ÌïôÍµê</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Noto+Sans+KR:wght@300;400;500;600;700;800;900&display=swap">
    
    <style>
      :root {
        --primary: #6366F1;
        --primary-dark: #4F46E5;
        --secondary: #EC4899;
        --accent: #F59E0B;
        --success: #10B981;
        --warning: #F59E0B;
        --danger: #EF4444;
        --dark: #0F172A;
        --light: #F8FAFC;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Poppins', 'Noto Sans KR', sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #1e293b;
        overflow-x: hidden;
        -webkit-tap-highlight-color: transparent;
      }

      /* Glassmorphism */
      .glass {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px) saturate(180%);
        -webkit-backdrop-filter: blur(20px) saturate(180%);
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      }

      .glass-white {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px) saturate(180%);
        -webkit-backdrop-filter: blur(20px) saturate(180%);
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
      }

      /* Premium Card */
      .premium-card {
        background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.85) 100%);
        backdrop-filter: blur(20px);
        border-radius: 24px;
        border: 1px solid rgba(255, 255, 255, 0.5);
        box-shadow: 
          0 20px 60px rgba(0, 0, 0, 0.1),
          0 0 0 1px rgba(255, 255, 255, 0.5) inset;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        overflow: hidden;
        position: relative;
      }

      .premium-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--primary), var(--secondary));
        opacity: 0;
        transition: opacity 0.3s;
      }

      .premium-card:hover {
        transform: translateY(-8px);
        box-shadow: 
          0 30px 80px rgba(0, 0, 0, 0.15),
          0 0 0 1px rgba(255, 255, 255, 0.5) inset;
      }

      .premium-card:hover::before {
        opacity: 1;
      }

      /* Animated Gradient Text */
      .gradient-text {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
        background-size: 200% 200%;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        animation: gradientShift 4s ease infinite;
      }

      @keyframes gradientShift {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
      }

      /* Animations */
      @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-20px); }
      }

      .float {
        animation: float 6s ease-in-out infinite;
      }

      @keyframes pulse-slow {
        0%, 100% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.8; transform: scale(1.05); }
      }

      .pulse-slow {
        animation: pulse-slow 3s ease-in-out infinite;
      }

      @keyframes glow {
        0%, 100% { 
          box-shadow: 0 0 20px rgba(99, 102, 241, 0.5), 0 0 40px rgba(99, 102, 241, 0.3), 0 0 60px rgba(99, 102, 241, 0.1);
        }
        50% { 
          box-shadow: 0 0 40px rgba(99, 102, 241, 0.8), 0 0 80px rgba(99, 102, 241, 0.5), 0 0 120px rgba(99, 102, 241, 0.3);
        }
      }

      .glow {
        animation: glow 2s ease-in-out infinite;
      }

      @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-30px); }
        60% { transform: translateY(-15px); }
      }

      .bounce {
        animation: bounce 2s ease infinite;
      }

      @keyframes zoomIn {
        from { opacity: 0; transform: scale(0.3); }
        50% { opacity: 1; }
        to { transform: scale(1); }
      }

      .zoom-in {
        animation: zoomIn 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
      }

      @keyframes flipIn {
        from { transform: perspective(400px) rotateY(90deg); opacity: 0; }
        to { transform: perspective(400px) rotateY(0); opacity: 1; }
      }

      .flip-in {
        animation: flipIn 0.8s ease-out forwards;
      }

      @keyframes slideUpBounce {
        0% { opacity: 0; transform: translateY(100px); }
        60% { transform: translateY(-20px); }
        80% { transform: translateY(10px); }
        100% { opacity: 1; transform: translateY(0); }
      }

      .slide-up-bounce {
        animation: slideUpBounce 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
      }

      @keyframes rotateIn {
        from { transform: rotate(-200deg) scale(0); opacity: 0; }
        to { transform: rotate(0) scale(1); opacity: 1; }
      }

      .rotate-in {
        animation: rotateIn 0.8s ease-out forwards;
      }

      @keyframes sparkle {
        0%, 100% { opacity: 1; transform: scale(1) rotate(0deg); }
        25% { opacity: 0.8; transform: scale(1.2) rotate(90deg); }
        50% { opacity: 1; transform: scale(0.8) rotate(180deg); }
        75% { opacity: 0.8; transform: scale(1.1) rotate(270deg); }
      }

      .sparkle {
        animation: sparkle 2s ease-in-out infinite;
      }

      @keyframes wave {
        0%, 100% { transform: translateY(0); }
        25% { transform: translateY(-10px); }
        75% { transform: translateY(10px); }
      }

      .wave-1 { animation: wave 1.5s ease-in-out infinite; animation-delay: 0s; }
      .wave-2 { animation: wave 1.5s ease-in-out infinite; animation-delay: 0.1s; }
      .wave-3 { animation: wave 1.5s ease-in-out infinite; animation-delay: 0.2s; }
      .wave-4 { animation: wave 1.5s ease-in-out infinite; animation-delay: 0.3s; }

      @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(60px); }
        to { opacity: 1; transform: translateY(0); }
      }

      .fade-in-up {
        animation: fadeInUp 0.8s ease-out forwards;
      }

      @keyframes fadeInScale {
        from { opacity: 0; transform: scale(0.8); }
        to { opacity: 1; transform: scale(1); }
      }

      .fade-in-scale {
        animation: fadeInScale 0.8s ease-out forwards;
      }

      @keyframes slideInRight {
        from { opacity: 0; transform: translateX(100px); }
        to { opacity: 1; transform: translateX(0); }
      }

      .slide-in-right {
        animation: slideInRight 0.8s ease-out forwards;
      }

      /* Number Counter Animation */
      .number-counter {
        font-variant-numeric: tabular-nums;
        font-feature-settings: 'tnum';
      }

      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }

      ::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
      }

      ::-webkit-scrollbar-thumb {
        background: rgba(99, 102, 241, 0.5);
        border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: rgba(99, 102, 241, 0.7);
      }

      /* Button Styles */
      .btn-premium {
        position: relative;
        overflow: hidden;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .btn-premium::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.3);
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
      }

      .btn-premium:hover::before {
        width: 300px;
        height: 300px;
      }

      /* Presentation Styles */
      .presentation-slide {
        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
        position: relative;
        overflow-y: auto; /* Enable scrolling for mobile */
        overflow-x: hidden;
        height: 100vh;
      }

      .presentation-slide::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(99, 102, 241, 0.1) 0%, transparent 70%);
        animation: rotate 20s linear infinite;
        pointer-events: none;
      }

      @keyframes rotate {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }

      @keyframes shimmer {
        0% { background-position: -1000px 0; }
        100% { background-position: 1000px 0; }
      }

      .shimmer {
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        background-size: 1000px 100%;
        animation: shimmer 2s infinite;
      }

      /* Responsive Typography - Adjusted for Mobile */
      .display-1 {
        font-size: clamp(2.5rem, 8vw, 8rem);
        font-weight: 900;
        line-height: 1.1;
        letter-spacing: -0.02em;
      }

      .display-2 {
        font-size: clamp(2rem, 6vw, 5rem);
        font-weight: 800;
        line-height: 1.2;
        letter-spacing: -0.01em;
      }

      .display-3 {
        font-size: clamp(1.5rem, 4vw, 4rem);
        font-weight: 700;
        line-height: 1.3;
      }

      /* Form Styles */
      .form-input {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        font-size: 14px;
        transition: all 0.3s;
        background: white;
      }

      .form-input:focus {
        outline: none;
        border-color: #6366F1;
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      }

      .form-label {
        display: block;
        margin-bottom: 8px;
        font-size: 14px;
        font-weight: 600;
        color: #475569;
      }

      .stagger-1 { animation-delay: 0.1s; }
      .stagger-2 { animation-delay: 0.2s; }
      .stagger-3 { animation-delay: 0.3s; }
      .stagger-4 { animation-delay: 0.4s; }
      .stagger-5 { animation-delay: 0.5s; }
      .stagger-6 { animation-delay: 0.6s; }

      @keyframes progressFill {
        from { width: 0%; }
      }

      .progress-animate {
        animation: progressFill 2s ease-out forwards;
      }

      /* Card Hover 3D Effect - Disabled on touch devices for better performance */
      @media (hover: hover) {
        .card-3d {
          transition: transform 0.3s ease;
          transform-style: preserve-3d;
        }
        .card-3d:hover {
          transform: perspective(1000px) rotateX(5deg) rotateY(-5deg) translateZ(20px);
        }
      }
      
      .file-upload-zone {
        border: 2px dashed #cbd5e1;
        border-radius: 12px;
        padding: 20px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s;
      }
      
      .file-upload-zone:hover {
        border-color: #6366F1;
        background: rgba(99, 102, 241, 0.05);
      }
      
      .file-upload-zone.has-file {
        border-color: #10B981;
        background: rgba(16, 185, 129, 0.05);
      }

      /* Presentation Content Wrapper */
      .presentation-content-wrapper {
        min-height: 100vh;
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        /* Mobile default: Start from top */
        justify-content: flex-start; 
        padding-top: 4rem;
        padding-bottom: 4rem;
      }

      /* Tablet and Desktop: Center if content fits */
      @media (min-width: 768px) {
        .presentation-content-wrapper {
          justify-content: center;
          padding-top: 0;
          padding-bottom: 0;
        }
      }
    </style>
</head>
<body>
    <div id="root"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef } = React;
        const { createRoot } = ReactDOM;

        // Default Data Template
        const getDefaultData = () => ({
          "schoolName": "ÏõêÎ¨µÍ≥†Îì±ÌïôÍµê",
          "academicYear": "2025",
          "semester": "2ÌïôÍ∏∞",
          "kpiData": [
                    {
                              "title": "Ï¢ÖÌï© ÎßåÏ°±ÎèÑ",
                              "value": 4.31,
                              "total": 5.0,
                              "change": 0.22,
                              "changeType": "negative",
                              "targetSlide": 1,
                              "icon": "‚≠ê"
                    },
                    {
                              "title": "Ï¥ù Ï∞∏Ïó¨ Ïù∏Ïõê",
                              "value": 696,
                              "unit": "Î™Ö",
                              "change": 67,
                              "changeType": "positive",
                              "targetSlide": 2,
                              "icon": "üë•"
                    },
                    {
                              "title": "Ï†ÑÎÖÑ ÎåÄÎπÑ Î≥ÄÌôî",
                              "value": 0.22,
                              "unit": "Ï†ê",
                              "change": 0.22,
                              "changeType": "negative",
                              "targetSlide": 7,
                              "icon": "üìà"
                    }
          ],
          "categoryData": [
                    { "name": "ÌïôÍµêÏûêÏπò", "2024": 4.18, "2025": 4.15 },
                    { "name": "ÍµêÏú°Í≥ºÏ†ï Ìé∏ÏÑ±¬∑Ïö¥ÏòÅ", "2024": 4.27, "2025": 4.23 },
                    { "name": "ÏàòÏóÖ¬∑ÌèâÍ∞Ä ÌòÅÏã†", "2024": 4.21, "2025": 4.17 },
                    { "name": "Ï±ÖÏûÑÍµêÏú°", "2024": 4.26, "2025": 4.21 },
                    { "name": "Ïù∏Î¨∏¬∑Í≥ºÌïô¬∑ÏòàÏ≤¥Îä•", "2024": 4.25, "2025": 4.18 },
                    { "name": "ÎØºÏ£ºÏãúÎØº ÍµêÏú°", "2024": 4.22, "2025": 4.19 },
                    { "name": "ÏïàÏ†ÑÌïú ÍµêÏú°Í≥µÍ∞Ñ", "2024": 4.22, "2025": 4.19 }
          ],
          "respondentData": [
                    { "name": "ÍµêÏõê", "value": 50, "color": "#6366F1", "avg": 4.55 },
                    { "name": "ÌïôÏÉù", "value": 551, "color": "#EC4899", "avg": 3.96 },
                    { "name": "ÌïôÎ∂ÄÎ™®", "value": 84, "color": "#10B981", "avg": 4.13 },
                    { "name": "ÏßÅÏõê", "value": 11, "color": "#F59E0B", "avg": 4.59 }
          ],
          "trendData": [
                    { "year": "2022", "teacher": 4.7, "student": 3.66, "parent": 4.2, "staff": 4.6, "overall": 4.04 },
                    { "year": "2023", "teacher": 4.9, "student": 4.11, "parent": 4.41, "staff": 4.64, "overall": 4.52 },
                    { "year": "2024", "teacher": 4.64, "student": 3.97, "parent": 4.26, "staff": 4.3, "overall": 4.09 },
                    { "year": "2025", "teacher": 4.55, "student": 3.96, "parent": 4.13, "staff": 4.59, "overall": 4.31 }
          ],
          "comparisonData": {
                    "teacher": { "average": 4.55, "highest": 4.78, "lowest": 4.16 },
                    "student": { "average": 3.96, "highest": 4.07, "lowest": 3.78 },
                    "parent": { "average": 4.13, "highest": 4.26, "lowest": 4.05 },
                    "staff": { "average": 4.59, "highest": 4.91, "lowest": 4.36 }
          },
          "topBottomItems": {
                    "teacherTop": [
                        { "title": "ÎèÖÏÑú¬∑ÌÜ†Î°†¬∑Ïù∏Î¨∏ÏÜåÏñëÍµêÏú° ÌîÑÎ°úÍ∑∏Îû® Ïö¥ÏòÅ", "score": 4.78, "category": "Ïù∏Î¨∏¬∑Í≥ºÌïô¬∑ÏòàÏ≤¥Îä•" },
                        { "title": "ÌïôÏóÖ ÏÑ±Ï†ÅÍ¥ÄÎ¶¨ Í≥µÏ†ïÏÑ±", "score": 4.76, "category": "ÏàòÏóÖ¬∑ÌèâÍ∞Ä ÌòÅÏã†" },
                        { "title": "ÏûêÍ∏∞Ï£ºÎèÑÏ†Å ÌïôÏäµÏó≠Îüâ Í∞ïÌôî ÌîÑÎ°úÍ∑∏Îû®", "score": 4.76, "category": "Ï±ÖÏûÑÍµêÏú°" }
                    ],
                    "teacherBottom": [
                        { "title": "ÎØºÏ£ºÏ†Å ÏÜåÌÜµÍ≥º ÌÜ†Ïùò¬∑ÌÜ†Î°†", "score": 4.16, "category": "ÌïôÍµêÏûêÏπò" },
                        { "title": "ÌïôÍµêÏóÖÎ¨¥ Ïû¨Íµ¨Ï°∞Ìôî", "score": 4.22, "category": "ÌïôÍµêÏûêÏπò" },
                        { "title": "Ï≤¥Ìóò Ï§ëÏã¨ ÏïàÏ†Ñ ÍµêÏú°", "score": 4.34, "category": "ÏïàÏ†ÑÌïú ÍµêÏú°Í≥µÍ∞Ñ" }
                    ],
                    "studentTop": [
                        { "title": "ÎèÖÏÑú¬∑ÌÜ†Î°†¬∑Ïù∏Î¨∏ÏÜåÏñëÍµêÏú° ÌîÑÎ°úÍ∑∏Îû®", "score": 4.07, "category": "Ïù∏Î¨∏¬∑Í≥ºÌïô¬∑ÏòàÏ≤¥Îä•" },
                        { "title": "ÌïôÏóÖ ÏÑ±Ï†ÅÍ¥ÄÎ¶¨ Í≥µÏ†ïÏÑ±", "score": 4.04, "category": "ÏàòÏóÖ¬∑ÌèâÍ∞Ä ÌòÅÏã†" },
                        { "title": "ÎßûÏ∂§Ìòï ÍµêÏú°Í≥ºÏ†ï Ïö¥ÏòÅ", "score": 4.03, "category": "ÍµêÏú°Í≥ºÏ†ï Ìé∏ÏÑ±¬∑Ïö¥ÏòÅ" }
                    ],
                    "studentBottom": [
                        { "title": "ÏàòÎ†®ÌôúÎèô", "score": 3.78, "category": "Ïù∏Î¨∏¬∑Í≥ºÌïô¬∑ÏòàÏ≤¥Îä•" },
                        { "title": "Ï≤¥Ìóò Ï§ëÏã¨ ÏïàÏ†Ñ ÍµêÏú°", "score": 3.86, "category": "ÏïàÏ†ÑÌïú ÍµêÏú°Í≥µÍ∞Ñ" },
                        { "title": "Í≥ºÏ†ïÏ§ëÏã¨ ÏàòÌñâ ÌèâÍ∞Ä", "score": 3.87, "category": "ÏàòÏóÖ¬∑ÌèâÍ∞Ä ÌòÅÏã†" }
                    ]
          },
          "aiInsights": [
                    {
                        "type": "achievement",
                        "title": "üèÜ ÎèÖÏÑú¬∑Ïù∏Î¨∏ ÍµêÏú° Í∞ïÏ†ê",
                        "content": "ÎèÖÏÑú¬∑ÌÜ†Î°†¬∑Ïù∏Î¨∏ÏÜåÏñëÍµêÏú°Ïù¥ ÍµêÏõê(4.78Ï†ê)Í≥º ÌïôÏÉù(4.07Ï†ê) Î™®ÎëêÏóêÏÑú ÏµúÍ≥† ÎßåÏ°±ÎèÑÎ•º Í∏∞Î°ùÌñàÏäµÎãàÎã§."
                    },
                    {
                        "type": "achievement",
                        "title": "üèÜ ÏßÅÏõê ÎßåÏ°±ÎèÑ ÏÉÅÏäπ",
                        "content": "ÏßÅÏõê ÎßåÏ°±ÎèÑÍ∞Ä 4.30Ï†êÏóêÏÑú 4.59Ï†êÏúºÎ°ú 0.29Ï†ê ÏÉÅÏäπÌñàÏäµÎãàÎã§."
                    },
                    {
                        "type": "improvement",
                        "title": "‚ö†Ô∏è ÏàòÎ†®ÌôúÎèô Í∞úÏÑ† ÌïÑÏöî",
                        "content": "ÌïôÏÉù ÏàòÎ†®ÌôúÎèô ÎßåÏ°±ÎèÑÍ∞Ä 3.78Ï†êÏúºÎ°ú Í∞ÄÏû• ÎÇÆÏäµÎãàÎã§. ÌïôÎ∂ÄÎ™®ÎèÑ 4.07Ï†êÏúºÎ°ú ÎÇÆÏùÄ Ìé∏ÏûÖÎãàÎã§."
                    },
                    {
                        "type": "improvement",
                        "title": "‚ö†Ô∏è ÏÜåÌÜµ Î¨∏Ìôî Î≥¥ÏôÑ",
                        "content": "ÍµêÏõêÏùò 'ÎØºÏ£ºÏ†Å ÏÜåÌÜµÍ≥º ÌÜ†Ïùò¬∑ÌÜ†Î°†' Ìï≠Î™©Ïù¥ 4.16Ï†êÏúºÎ°ú Í∞úÏÑ†Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§."
                    },
                    {
                        "type": "action",
                        "title": "üéØ Ï¶âÏãú Ï°∞Ïπò",
                        "content": "ÏàòÎ†®ÌôúÎèô ÌîÑÎ°úÍ∑∏Îû® Í∞úÏÑ† Î∞è ÌïôÍµê ÎÇ¥ ÏÜåÌÜµ Î¨∏Ìôî Í∞ïÌôî Î∞©Ïïà ÎßàÎ†®Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§."
                    }
          ],
          "voices": [
                    "ÏàòÌïôÏó¨Ìñâ Í∞ÄÍ≥† Ïã∂Ïñ¥Ïöî",
                    "Ï≤¥Ïú°Î≥µ Îì±ÍµêÏùº Ïàò Ï¶ùÍ∞Ä Ìù¨Îßù",
                    "2ÌïôÎÖÑ ÏàòÎ†®ÌôúÎèô ÏãúÌñâ ÏöîÏ≤≠",
                    "Ï≤¥Ïú°Í¥Ä Ï†êÏã¨ÏãúÍ∞Ñ Í∞úÎ∞© Ìù¨Îßù",
                    "2ÌïôÍ∏∞ Ï§ëÍ∞ÑÏãúÌóò ÏùºÏ†ï Ï°∞Ï†ï Í±¥Ïùò"
          ],
          "responseRates": {
              "teacher": 92.6,
              "student": 68.9,
              "parent": 10.5,
              "staff": 100
          },
          "actionItems": [
                    {
                        "priority": 1,
                        "title": "ÏàòÎ†®ÌôúÎèô Í∞úÏÑ†",
                        "details": ["ÌïôÏÉù¬∑ÌïôÎ∂ÄÎ™® ÏùòÍ≤¨ Î∞òÏòÅÌïú ÌîÑÎ°úÍ∑∏Îû® Ïû¨ÏÑ§Í≥Ñ", "ÏàòÎ†®ÌôúÎèô ÎßåÏ°±ÎèÑ Î™©Ìëú 4.0Ï†ê Ïù¥ÏÉÅ"],
                        "icon": "üéØ"
                    },
                    {
                        "priority": 2,
                        "title": "ÏÜåÌÜµ Î¨∏Ìôî Í∞ïÌôî",
                        "details": ["ÍµêÏßÅÏõê Í∞Ñ ÎØºÏ£ºÏ†Å ÌÜ†Ïùò¬∑ÌÜ†Î°† ÌôúÏÑ±Ìôî", "ÏùòÍ≤¨ ÏàòÎ†¥ Ï±ÑÎÑê Îã§ÏñëÌôî"],
                        "icon": "üí¨"
                    },
                    {
                        "priority": 3,
                        "title": "Ïö∞Ïàò ÌîÑÎ°úÍ∑∏Îû® ÌôïÎåÄ",
                        "details": ["ÎèÖÏÑú¬∑Ïù∏Î¨∏ ÍµêÏú° ÌîÑÎ°úÍ∑∏Îû® ÏßÄÏÜç Í∞ïÌôî", "ÏÑ±Í≥µ ÏÇ¨Î°Ä Í≥µÏú† Î∞è ÌôïÏÇ∞"],
                        "icon": "üìö"
                    }
          ],
          "roadmap": [
                    { "quarter": "1Î∂ÑÍ∏∞", "period": "3-5Ïõî", "task": "Í∞úÏÑ† Í≥ÑÌöç ÏàòÎ¶Ω", "color": "#6366F1" },
                    { "quarter": "2Î∂ÑÍ∏∞", "period": "6-8Ïõî", "task": "Ïã§Ìñâ Î∞è Î™®ÎãàÌÑ∞ÎßÅ", "color": "#10B981" },
                    { "quarter": "3Î∂ÑÍ∏∞", "period": "9-11Ïõî", "task": "Ï§ëÍ∞Ñ Ï†êÍ≤Ä Î∞è Î≥¥ÏôÑ", "color": "#F59E0B" },
                    { "quarter": "4Î∂ÑÍ∏∞", "period": "12-2Ïõî", "task": "Ìö®Í≥º Ï∏°Ï†ï Î∞è ÌîºÎìúÎ∞±", "color": "#EC4899" }
          ],
          "goal": { "currentScore": 4.31, "targetScore": 4.32, "currentRank": 0, "targetRank": 0, "totalSchools": 0 }
        });

        // LocalStorage Keys
        const STORAGE_KEY = 'schoolEvaluationData_v2';
        
        // Load data from localStorage
        const loadFromStorage = () => {
            try {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) {
                    const parsed = JSON.parse(saved);
                    // Migration checks
                    if (!parsed.responseRates) {
                        parsed.responseRates = { teacher: 100, student: 100, parent: 100, staff: 100 };
                    }
                    return parsed;
                }
            } catch (e) {
                console.error('Failed to load from localStorage:', e);
            }
            return null;
        };
        
        // Save data to localStorage
        const saveToStorage = (data) => {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
                return true;
            } catch (e) {
                console.error('Failed to save to localStorage:', e);
                return false;
            }
        };

        // Excel Parser Functions
        const parseExcelFile = (file) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                        const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                        resolve(jsonData);
                    } catch (err) {
                        reject(err);
                    }
                };
                reader.onerror = reject;
                reader.readAsArrayBuffer(file);
            });
        };

        // Parse respondent file (ÍµêÏõê/ÌïôÏÉù/ÌïôÎ∂ÄÎ™®/ÏßÅÏõê)
        const parseRespondentFile = (data, type) => {
            const result = {
                respondentCount: 0,
                averageScore: 0,
                highestScore: 0,
                lowestScore: 5,
                highestItem: { title: '', score: 0 },
                lowestItem: { title: '', score: 5 },
                topItems: [],
                bottomItems: [],
                subCategoryScores: {},      // ÏÑ∏Î∂ÄÏòÅÏó≠Î≥Ñ ÌòÑÏû¨ Ï†êÏàò
                subCategoryScoresPrev: {},  // ÏÑ∏Î∂ÄÏòÅÏó≠Î≥Ñ Ï†ÑÎÖÑÎèÑ Ï†êÏàò
                allItems: []
            };
            
            // Ï¥ù ÏùëÎãµÏù∏Ïõê Ï∞æÍ∏∞ (Ìñâ 0, Ïó¥ 10)
            if (data[0] && data[0][10] !== undefined && typeof data[0][10] === 'number') {
                result.respondentCount = data[0][10];
            }
            
            // ÏùëÎãµÏù∏ÏõêÏùÑ Î™ª Ï∞æÏúºÎ©¥ Îã§Î•∏ Î∞©Î≤ïÏúºÎ°ú ÏãúÎèÑ
            if (result.respondentCount === 0) {
                for (let i = 0; i < Math.min(3, data.length); i++) {
                    for (let j = 8; j < 12; j++) {
                        const cell = data[i] && data[i][j];
                        if (typeof cell === 'number' && cell >= 10 && cell <= 2000) {
                            result.respondentCount = cell;
                            break;
                        }
                    }
                    if (result.respondentCount > 0) break;
                }
            }

            let currentCategory = '';
            let currentSubCategory = '';
            let scores = [];
            let subCategoryItemScores = {};  // ÏÑ∏Î∂ÄÏòÅÏó≠Î≥Ñ Î¨∏Ìï≠ Ï†êÏàòÎì§
            
            // Ìñâ 3Î∂ÄÌÑ∞ Îç∞Ïù¥ÌÑ∞ ÌååÏã± (ÏùëÎãµÏù∏Ïõê ÌñâÎßå Ï≤òÎ¶¨)
            for (let i = 3; i < data.length; i++) {
                const row = data[i];
                if (!row || row.length < 11) continue;
                
                // Ïó¥ 4Í∞Ä 'ÏùëÎãµÏù∏Ïõê'Ïù∏ ÌñâÎßå Ï≤òÎ¶¨
                const col4 = row[4];
                if (!col4 || String(col4).trim() !== 'ÏùëÎãµÏù∏Ïõê') continue;
                
                // ÏòÅÏó≠ (Ïó¥ 0)
                const col0 = row[0];
                if (col0 && typeof col0 === 'string' && col0.length > 0) {
                    currentCategory = col0.replace(/[\n\r]/g, ' ').trim();
                }
                
                // ÏÑ∏Î∂ÄÏòÅÏó≠ (Ïó¥ 1)
                const col1 = row[1];
                if (col1 && typeof col1 === 'string' && col1.length > 0) {
                    currentSubCategory = col1.replace(/[\n\r]/g, ' ').trim();
                }
                
                // ÏßàÎ¨∏ ÌÖçÏä§Ìä∏ (Ïó¥ 3)
                const questionText = row[3];
                if (!questionText || typeof questionText !== 'string') continue;
                
                // Ï†êÏàò (Ïó¥ 10)
                const score = row[10];
                if (typeof score !== 'number' || score < 1 || score > 5) continue;
                
                // 2024ÎÖÑÎèÑ Ï†êÏàò (Ïó¥ 12)
                const prevScore = row[12];
                
                // ÏÑ∏Î∂ÄÏòÅÏó≠Î≥Ñ Ï†êÏàò ÏàòÏßë
                if (currentSubCategory) {
                    if (!subCategoryItemScores[currentSubCategory]) {
                        subCategoryItemScores[currentSubCategory] = { current: [], prev: [] };
                    }
                    subCategoryItemScores[currentSubCategory].current.push(score);
                    if (typeof prevScore === 'number' && prevScore >= 1 && prevScore <= 5) {
                        subCategoryItemScores[currentSubCategory].prev.push(prevScore);
                    }
                }
                
                // ÏßàÎ¨∏ ÌÖçÏä§Ìä∏ Ï†ïÎ¶¨
                const cleanQuestion = questionText.split('\n')[0].replace(/^\d+\.\s*/, '').trim();
                
                if (cleanQuestion.length > 5) {
                    const item = {
                        title: cleanQuestion.length > 60 ? cleanQuestion.substring(0, 60) + '...' : cleanQuestion,
                        score: parseFloat(score.toFixed(2)),
                        category: currentCategory,
                        subCategory: currentSubCategory
                    };
                    
                    result.allItems.push(item);
                    scores.push(score);
                    
                    if (score > result.highestScore) {
                        result.highestScore = score;
                        result.highestItem = item;
                    }
                    if (score < result.lowestScore) {
                        result.lowestScore = score;
                        result.lowestItem = item;
                    }
                }
            }
            
            // ÏÑ∏Î∂ÄÏòÅÏó≠Î≥Ñ ÌèâÍ∑† Ï†êÏàò Í≥ÑÏÇ∞
            for (const [subCat, itemScores] of Object.entries(subCategoryItemScores)) {
                if (itemScores.current.length > 0) {
                    result.subCategoryScores[subCat] = parseFloat(
                        (itemScores.current.reduce((a, b) => a + b, 0) / itemScores.current.length).toFixed(2)
                    );
                }
                if (itemScores.prev.length > 0) {
                    result.subCategoryScoresPrev[subCat] = parseFloat(
                        (itemScores.prev.reduce((a, b) => a + b, 0) / itemScores.prev.length).toFixed(2)
                    );
                }
            }
            
            // Ï†ÑÏ≤¥ ÌèâÍ∑† Ï†êÏàò Í≥ÑÏÇ∞
            if (scores.length > 0) {
                result.averageScore = parseFloat((scores.reduce((a, b) => a + b, 0) / scores.length).toFixed(2));
            }
            
            // TOP 3 / ÌïòÏúÑ 3 Ï†ïÎ†¨
            const sortedItems = [...result.allItems].sort((a, b) => b.score - a.score);
            result.topItems = sortedItems.slice(0, 3);
            result.bottomItems = [...result.allItems].sort((a, b) => a.score - b.score).slice(0, 3);
            
            // Ï†êÏàò Î∞òÏò¨Î¶º
            result.highestScore = parseFloat(result.highestScore.toFixed(2));
            result.lowestScore = result.lowestScore < 5 ? parseFloat(result.lowestScore.toFixed(2)) : 0;
            
            console.log(`Parsed ${type}: count=${result.respondentCount}, avg=${result.averageScore}, items=${result.allItems.length}`);
            console.log(`Sub-category scores:`, result.subCategoryScores);
            
            return result;
        };

        // Parse trend file (Ïó∞ÎèÑÎ≥Ñ Ï∂îÏù¥)
        const parseTrendFile = (data) => {
            const result = [];
            
            for (let i = 2; i < data.length; i++) {
                const row = data[i];
                if (!row || row.length < 5) continue;
                
                const yearCell = row[0];
                if (!yearCell) continue;
                
                // ÎÖÑÎèÑ Ï∂îÏ∂ú (Ïòà: "2025ÎÖÑ" -> "2025")
                const yearMatch = String(yearCell).match(/(\d{4})/);
                if (yearMatch) {
                    const year = yearMatch[1];
                    const teacher = parseFloat(row[1]) || 0;
                    const student = parseFloat(row[2]) || 0;
                    const parent = parseFloat(row[3]) || 0;
                    const staff = parseFloat(row[4]) || 0;
                    
                    // Ï†ÑÏ≤¥ ÌèâÍ∑† Í≥ÑÏÇ∞ (Îã®Ïàú ÌèâÍ∑†)
                    const overall = parseFloat(((teacher + student + parent + staff) / 4).toFixed(2));
                    
                    result.push({
                        year,
                        teacher: parseFloat(teacher.toFixed(2)),
                        student: parseFloat(student.toFixed(2)),
                        parent: parseFloat(parent.toFixed(2)),
                        staff: parseFloat(staff.toFixed(2)),
                        overall
                    });
                }
            }
            
            // ÎÖÑÎèÑÏàú Ï†ïÎ†¨
            result.sort((a, b) => parseInt(a.year) - parseInt(b.year));
            
            // ÏµúÍ∑º 4Í∞úÎÖÑÎßå Ïú†ÏßÄ
            const finalResult = result.slice(-4);
            
            return finalResult;
        };

        // Generate AI Insights based on data
        const generateAIInsights = (teacherData, studentData, parentData, staffData) => {
            const insights = [];
            
            // Find achievements
            if (teacherData.topItems.length > 0) {
                insights.push({
                    type: 'achievement',
                    title: 'üèÜ ÍµêÏõê ÏµúÍ≥† ÏÑ±Í≥º',
                    content: `${teacherData.topItems[0].title.substring(0, 40)}...Ïù¥(Í∞Ä) ${teacherData.topItems[0].score}Ï†êÏúºÎ°ú ÍµêÏõê ÌèâÍ∞Ä ÏµúÍ≥† ÎßåÏ°±ÎèÑÎ•º Í∏∞Î°ùÌñàÏäµÎãàÎã§.`
                });
            }
            
            // Staff improvement
            if (staffData.averageScore > 0) {
                insights.push({
                    type: 'achievement',
                    title: 'üèÜ ÏßÅÏõê ÌèâÍ∞Ä',
                    content: `ÏßÅÏõê ÎßåÏ°±ÎèÑÍ∞Ä ${staffData.averageScore}Ï†êÏúºÎ°ú Ï∏°Ï†ïÎêòÏóàÏäµÎãàÎã§.`
                });
            }
            
            // Find improvements needed
            if (teacherData.bottomItems.length > 0) {
                insights.push({
                    type: 'improvement',
                    title: '‚ö†Ô∏è Í∞úÏÑ† ÌïÑÏöî (ÍµêÏõê)',
                    content: `${teacherData.bottomItems[0].title.substring(0, 40)}...Ïù¥(Í∞Ä) ${teacherData.bottomItems[0].score}Ï†êÏúºÎ°ú ÍµêÏõê ÌèâÍ∞Ä Ï§ë Í∞ÄÏû• ÎÇÆÏäµÎãàÎã§.`
                });
            }
            
            if (studentData.bottomItems.length > 0) {
                insights.push({
                    type: 'improvement',
                    title: '‚ö†Ô∏è Í∞úÏÑ† ÌïÑÏöî (ÌïôÏÉù)',
                    content: `${studentData.bottomItems[0].title.substring(0, 40)}...Ïù¥(Í∞Ä) ${studentData.bottomItems[0].score}Ï†êÏúºÎ°ú ÌïôÏÉù ÌèâÍ∞Ä Ï§ë Í∞ÄÏû• ÎÇÆÏäµÎãàÎã§.`
                });
            }
            
            // Action item
            insights.push({
                type: 'action',
                title: 'üéØ Ï¶âÏãú Ï°∞Ïπò',
                content: 'ÎÇÆÏùÄ ÎßåÏ°±ÎèÑ Ìï≠Î™©Ïóê ÎåÄÌïú Í∞úÏÑ† Í≥ÑÌöç ÏàòÎ¶ΩÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.'
            });
            
            return insights;
        };

        // Generate Action Items
        const generateActionItems = (teacherData, studentData) => {
            const items = [];
            
            if (studentData.bottomItems.length > 0) {
                items.push({
                    priority: 1,
                    title: 'ÌïôÏÉù ÎßåÏ°±ÎèÑ Í∞úÏÑ†',
                    details: [studentData.bottomItems[0].title.substring(0, 30) + '... Í∞úÏÑ†', 'ÌïôÏÉù ÏùòÍ≤¨ ÏàòÎ†¥ ÌôïÎåÄ'],
                    icon: 'üéØ'
                });
            }
            
            if (teacherData.bottomItems.length > 0) {
                items.push({
                    priority: 2,
                    title: 'ÍµêÏõê ÏßÄÏõê Í∞ïÌôî',
                    details: [teacherData.bottomItems[0].title.substring(0, 30) + '... Í∞úÏÑ†', 'ÍµêÏõê ÏùòÍ≤¨ Î∞òÏòÅ'],
                    icon: 'üí¨'
                });
            }
            
            items.push({
                priority: 3,
                title: 'Ïö∞Ïàò ÌîÑÎ°úÍ∑∏Îû® ÌôïÎåÄ',
                details: ['ÎÜíÏùÄ ÎßåÏ°±ÎèÑ ÌîÑÎ°úÍ∑∏Îû® Ïú†ÏßÄ', 'ÏÑ±Í≥µ ÏÇ¨Î°Ä Í≥µÏú†'],
                icon: 'üìö'
            });
            
            return items;
        };

        // Custom Hook: useCountUp
        const useCountUp = (end, start = 0, duration = 2000, decimals = 2) => {
            const [count, setCount] = useState(start);
            const animationFrameId = useRef(null);
            
            useEffect(() => {
                let frame = 0;
                const totalFrames = Math.round(duration / (1000 / 60));
                const easeOutExpo = t => t === 1 ? 1 : 1 - Math.pow(2, -10 * t);
                
                const counter = () => {
                    frame++;
                    const progress = easeOutExpo(frame / totalFrames);
                    const currentCount = start + (end - start) * progress;
                    setCount(parseFloat(currentCount.toFixed(decimals)));
                    
                    if (frame < totalFrames) {
                        animationFrameId.current = requestAnimationFrame(counter);
                    } else {
                        setCount(end);
                    }
                };
                
                animationFrameId.current = requestAnimationFrame(counter);
                
                return () => {
                    if (animationFrameId.current) {
                        cancelAnimationFrame(animationFrameId.current);
                    }
                };
            }, [end, start, duration, decimals]);
            
            return count;
        };

        // Icons
        const SchoolIcon = () => (
            <svg className="w-full h-full" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M12 3L1 9l11 6 9-4.91V17h2V9L12 3z"/>
                <path d="M5 13.18v4L12 21l7-3.82v-4"/>
            </svg>
        );

        const SparkleIcon = () => (
            <svg className="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 0L14.59 9.41L24 12L14.59 14.59L12 24L9.41 14.59L0 12L9.41 9.41L12 0Z"/>
            </svg>
        );

        // Premium Chart Components
        const PremiumPieChart = ({ data }) => {
            const canvasRef = useRef(null);
            const chartRef = useRef(null);

            useEffect(() => {
                if (canvasRef.current) {
                    const ctx = canvasRef.current.getContext('2d');
                    
                    if (chartRef.current) {
                        chartRef.current.destroy();
                    }

                    chartRef.current = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: data.map(d => d.name),
                            datasets: [{
                                data: data.map(d => d.value),
                                backgroundColor: data.map(d => d.color),
                                borderWidth: 4,
                                borderColor: '#ffffff',
                                hoverBorderColor: '#ffffff',
                                hoverBorderWidth: 6,
                                hoverOffset: 15,
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            cutout: '60%',
                            plugins: {
                                legend: { display: false },
                                tooltip: {
                                    backgroundColor: 'rgba(15, 23, 42, 0.95)',
                                    titleFont: { size: 14, weight: 'bold' },
                                    bodyFont: { size: 12 },
                                    padding: 16,
                                    cornerRadius: 12,
                                    displayColors: false,
                                }
                            },
                            animation: {
                                animateRotate: true,
                                animateScale: true,
                                duration: 1500,
                                easing: 'easeInOutQuart'
                            }
                        }
                    });
                }

                return () => {
                    if (chartRef.current) {
                        chartRef.current.destroy();
                    }
                };
            }, [data]);

            return (
                <div className="flex items-center justify-center w-full h-64 md:h-80 lg:h-96">
                    <canvas ref={canvasRef}></canvas>
                </div>
            );
        };

        const PremiumBarChart = ({ data }) => {
            const canvasRef = useRef(null);
            const chartRef = useRef(null);

            useEffect(() => {
                if (canvasRef.current) {
                    const ctx = canvasRef.current.getContext('2d');
                    
                    if (chartRef.current) {
                        chartRef.current.destroy();
                    }

                    const currentYear = data[0] ? Object.keys(data[0]).find(k => k !== 'name' && k !== '2024') : '2025';
                    const prevYear = '2024';

                    chartRef.current = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: data.map(d => d.name),
                            datasets: [
                                {
                                    label: prevYear + 'ÎÖÑ',
                                    data: data.map(d => d[prevYear] || d['2024'] || 0),
                                    backgroundColor: 'rgba(148, 163, 184, 0.8)',
                                    borderRadius: 8,
                                    borderSkipped: false,
                                },
                                {
                                    label: currentYear + 'ÎÖÑ',
                                    data: data.map(d => d[currentYear] || d['2025'] || 0),
                                    backgroundColor: (context) => {
                                        const gradient = context.chart.ctx.createLinearGradient(0, 0, 0, 400);
                                        gradient.addColorStop(0, '#818CF8');
                                        gradient.addColorStop(1, '#6366F1');
                                        return gradient;
                                    },
                                    borderRadius: 8,
                                    borderSkipped: false,
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        usePointStyle: true,
                                        padding: 15,
                                        font: { size: 12, weight: '500' }
                                    }
                                },
                                tooltip: {
                                    backgroundColor: 'rgba(15, 23, 42, 0.95)',
                                    titleFont: { size: 14, weight: 'bold' },
                                    bodyFont: { size: 12 },
                                    padding: 12,
                                    cornerRadius: 12,
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: false,
                                    min: 3.5,
                                    max: 4.5,
                                    grid: { color: 'rgba(0, 0, 0, 0.05)' },
                                    ticks: { font: { size: 11 } }
                                },
                                x: {
                                    grid: { display: false },
                                    ticks: { font: { size: 10 }, maxRotation: 45, minRotation: 45 }
                                }
                            },
                            animation: {
                                duration: 1500,
                                easing: 'easeInOutQuart'
                            }
                        }
                    });
                }

                return () => {
                    if (chartRef.current) {
                        chartRef.current.destroy();
                    }
                };
            }, [data]);

            return <canvas ref={canvasRef}></canvas>;
        };

        // Premium Splash Screen
        const PremiumSplashScreen = ({ onFinished, schoolData }) => {
            const [progress, setProgress] = useState(0);

            useEffect(() => {
                const interval = setInterval(() => {
                    setProgress(prev => {
                        if (prev >= 100) {
                            clearInterval(interval);
                            setTimeout(onFinished, 500);
                            return 100;
                        }
                        return prev + 2;
                    });
                }, 30);

                return () => clearInterval(interval);
            }, [onFinished]);

            const totalParticipants = schoolData.kpiData.find(k => k.title === 'Ï¥ù Ï∞∏Ïó¨ Ïù∏Ïõê')?.value || 0;

            return (
                <div className="fixed inset-0 bg-gradient-to-br from-indigo-600 to-purple-600 flex flex-col items-center justify-center z-50 p-4">
                    <div className="mb-8 md:mb-12 float">
                        <div className="w-24 h-24 md:w-40 md:h-40 text-white glow rounded-full p-4">
                            <SchoolIcon />
                        </div>
                    </div>
                    <h1 className="text-4xl md:text-7xl font-black text-white mb-4 tracking-tight zoom-in text-center">
                        {schoolData.academicYear} ÌïôÍµêÌèâÍ∞Ä
                    </h1>
                    <p className="text-xl md:text-4xl text-white/80 font-medium mb-4 fade-in-up stagger-2 text-center">
                        {schoolData.semester} Î∂ÑÏÑù ÎåÄÏãúÎ≥¥Îìú
                    </p>
                    <div className="flex items-center gap-2 md:gap-4 text-white/90 text-lg md:text-2xl mb-12 md:mb-16 fade-in-up stagger-3">
                        <SparkleIcon />
                        <span className="font-medium">{totalParticipants.toLocaleString()}Î™ÖÏùò ÏÜåÏ§ëÌïú ÏùòÍ≤¨</span>
                        <SparkleIcon />
                    </div>
                    <div className="w-full max-w-xs md:max-w-md mx-auto fade-in-up stagger-4">
                        <div className="h-3 bg-white/20 rounded-full overflow-hidden">
                            <div 
                                className="h-full bg-white rounded-full shimmer transition-all duration-300"
                                style={{ width: `${progress}%` }}
                            ></div>
                        </div>
                        <p className="text-white/70 text-center mt-4 text-base md:text-lg">{progress}% Î°úÎî© Ï§ë...</p>
                    </div>
                </div>
            );
        };

        // Header Component
        const PremiumHeader = ({ schoolData, onEnterPresentation, onOpenDataEditor }) => {
            const handleFullScreen = () => { 
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(err => {
                        console.error(`Error: ${err.message}`);
                    }); 
                } else {
                    document.exitFullscreen();
                }
            };
            
            return (
                <header className="glass sticky top-0 z-50 px-4 md:px-8 py-3 md:py-4">
                    <div className="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
                        <div className="flex items-center gap-4 w-full md:w-auto">
                            <div className="w-10 h-10 md:w-12 md:h-12 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center text-white shadow-lg shrink-0">
                                <SchoolIcon />
                            </div>
                            <div className="overflow-hidden">
                                <h1 className="text-lg md:text-2xl font-bold text-white truncate">{schoolData.schoolName}</h1>
                                <p className="text-xs md:text-sm text-white/70 truncate">{schoolData.academicYear}ÌïôÎÖÑÎèÑ {schoolData.semester} Î∂ÑÏÑù</p>
                            </div>
                        </div>
                        <div className="flex items-center gap-2 md:gap-3 w-full md:w-auto justify-end">
                            <button 
                                onClick={onOpenDataEditor}
                                className="btn-premium px-4 py-2 md:px-6 md:py-3 bg-white/20 hover:bg-white/30 text-white rounded-xl font-semibold backdrop-blur-xl transition-all text-sm md:text-base whitespace-nowrap"
                            >
                                ‚úèÔ∏è ÏÑ§Ï†ï
                            </button>
                            <button 
                                onClick={handleFullScreen}
                                className="btn-premium p-2 md:p-3 bg-white/20 hover:bg-white/30 text-white rounded-xl backdrop-blur-xl transition-all hidden md:block"
                            >
                                ‚õ∂
                            </button>
                            <button 
                                onClick={() => onEnterPresentation()}
                                className="btn-premium px-4 py-2 md:px-6 md:py-3 bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white rounded-xl font-bold shadow-lg transition-all text-sm md:text-base whitespace-nowrap"
                            >
                                üé¨ Î∞úÌëú
                            </button>
                        </div>
                    </div>
                </header>
            );
        };

        // KPI Card Component
        const PremiumKpiCard = ({ data, onDetailClick, delay = 0 }) => {
            const animatedValue = useCountUp(data.value, 0, 2000, data.total ? 2 : (data.unit === '%' ? 1 : 0));
            
            return (
                <div 
                    className="premium-card stat-card p-6 md:p-8 cursor-pointer fade-in-up card-3d"
                    style={{ animationDelay: `${delay}ms` }}
                    onClick={onDetailClick}
                >
                    <div className="flex justify-between items-start mb-4 md:mb-6">
                        <div>
                            <p className="text-xs md:text-sm font-semibold text-gray-500 uppercase tracking-wider mb-1 md:mb-2">
                                {data.title}
                            </p>
                            <div className="flex items-baseline gap-2 flex-wrap">
                                <span className="text-3xl md:text-5xl font-black text-gray-900 number-counter">
                                    {animatedValue.toLocaleString(undefined, { 
                                        minimumFractionDigits: data.total ? 2 : (data.unit === '%' ? 1 : 0), 
                                        maximumFractionDigits: data.total ? 2 : (data.unit === '%' ? 1 : 0)
                                    })}
                                </span>
                                {data.total && (
                                    <span className="text-xl md:text-2xl font-bold text-gray-400">
                                        /{data.total.toFixed(2)}
                                    </span>
                                )}
                                {data.unit && (
                                    <span className="text-xl md:text-2xl font-bold text-gray-400">{data.unit}</span>
                                )}
                            </div>
                        </div>
                        <div className="text-4xl md:text-5xl pulse-slow">
                            {data.icon}
                        </div>
                    </div>
                    <div className="flex items-center gap-2">
                        <span className={`inline-flex items-center px-2 py-1 md:px-3 md:py-1 rounded-full text-xs md:text-sm font-bold ${
                            data.change >= 0 ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'
                        }`}>
                            {data.change >= 0 ? '‚ñ≤' : '‚ñº'} {data.change > 0 ? '+' : ''}{typeof data.change === 'number' ? data.change.toFixed(2) : data.change}
                        </span>
                        <span className="text-xs md:text-sm text-gray-500">Ï†ÑÎÖÑ ÎåÄÎπÑ</span>
                    </div>
                </div>
            );
        };

        // Category Chart Card
        const CategoryChartCard = ({ data, academicYear }) => {
            return (
                <div className="glass-white rounded-3xl p-6 md:p-8 h-full fade-in-up" style={{ animationDelay: '300ms' }}>
                    <div className="flex flex-col md:flex-row items-start md:items-center justify-between mb-6 md:mb-8 gap-4">
                        <div>
                            <h3 className="text-xl md:text-2xl font-bold text-gray-900 mb-1 md:mb-2">Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ ÎßåÏ°±ÎèÑ</h3>
                            <p className="text-sm md:text-base text-gray-500">{parseInt(academicYear) - 1} vs {academicYear} ÎπÑÍµê Î∂ÑÏÑù</p>
                        </div>
                        <div className="inline-flex items-center px-3 py-1 md:px-4 md:py-2 rounded-full text-xs md:text-sm font-bold bg-indigo-100 text-indigo-700">
                            {data.length}Í∞ú Ìï≠Î™©
                        </div>
                    </div>
                    <div className="h-64 md:h-96">
                        <PremiumBarChart data={data} />
                    </div>
                </div>
            );
        };

        // AI Insights Panel
        const PremiumAiInsightsPanel = ({ aiInsights, voices }) => {
            return (
                <div className="glass-white rounded-3xl p-6 md:p-8 h-full flex flex-col fade-in-up" style={{ animationDelay: '400ms' }}>
                    <div className="flex items-center gap-3 mb-6">
                        <div className="w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center">
                            <span className="text-xl">ü§ñ</span>
                        </div>
                        <h3 className="text-xl md:text-2xl font-bold text-gray-900">AI Ïù∏ÏÇ¨Ïù¥Ìä∏</h3>
                    </div>
                    
                    <div className="flex-1 space-y-4 overflow-y-auto pr-2 mb-6 max-h-[400px] md:max-h-none">
                        {aiInsights.length > 0 ? aiInsights.map((insight, index) => (
                            <div 
                                key={index}
                                className="premium-card p-4 md:p-6 hover:shadow-2xl transition-all"
                            >
                                <h4 className="text-base md:text-lg font-bold text-gray-800 mb-2 md:mb-3 flex items-center gap-2">
                                    {insight.title}
                                </h4>
                                <p className="text-gray-600 leading-relaxed text-xs md:text-sm">
                                    {insight.content}
                                </p>
                            </div>
                        )) : (
                            <div className="text-center text-gray-500 py-8">
                                <p>Îç∞Ïù¥ÌÑ∞Î•º ÏóÖÎ°úÎìúÌïòÎ©¥ AI Ïù∏ÏÇ¨Ïù¥Ìä∏Í∞Ä ÏÉùÏÑ±Îê©ÎãàÎã§.</p>
                            </div>
                        )}
                    </div>

                    {voices && voices.length > 0 && (
                        <div className="border-t pt-6">
                            <h4 className="text-lg font-bold text-gray-900 mb-4 flex items-center gap-2">
                                <span>üí¨</span> ÏÉùÏÉùÌïú Î™©ÏÜåÎ¶¨
                            </h4>
                            <div className="space-y-3">
                                {voices.map((voice, index) => (
                                    <div key={index} className="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-4">
                                        <p className="text-gray-800 font-medium mb-2 flex items-start gap-2 text-sm md:text-base">
                                            <span className="text-lg">{voice.emoji}</span>
                                            <span className="flex-1">{voice.text}</span>
                                        </p>
                                        <p className="text-xs md:text-sm text-gray-500 text-right">- {voice.source}</p>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Dashboard Component
        const PremiumDashboard = ({ schoolData, onEnterPresentation, onOpenDataEditor }) => {
            
            const getResponseRate = (group) => {
                const map = { 'ÍµêÏõê': 'teacher', 'ÌïôÏÉù': 'student', 'ÌïôÎ∂ÄÎ™®': 'parent', 'ÏßÅÏõê': 'staff' };
                return schoolData.responseRates[map[group]] || 0;
            };

            return (
                <div className="min-h-screen pb-12">
                    <PremiumHeader 
                        schoolData={schoolData} 
                        onEnterPresentation={onEnterPresentation}
                        onOpenDataEditor={onOpenDataEditor}
                    />
                    
                    <main className="max-w-7xl mx-auto px-4 md:px-8 py-8 md:py-12">
                        {/* Hero Section */}
                        <div className="text-center mb-8 md:mb-16 fade-in-up">
                            <h2 className="display-2 text-white mb-2 md:mb-4">
                                {schoolData.academicYear} ÌïôÍµê ÌèâÍ∞Ä Î¶¨Ìè¨Ìä∏ 
                            </h2>
                            <p className="text-base md:text-xl text-white/80 font-medium">
                                Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞òÏùò Ï†ïÌôïÌïú Ïù∏ÏÇ¨Ïù¥Ìä∏ÏôÄ Í∞úÏÑ† Î∞©Ìñ•
                            </p>
                        </div>

                        {/* KPI Cards */}
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 mb-8 md:mb-12">
                            {schoolData.kpiData.map((kpi, index) => (
                                <PremiumKpiCard 
                                    key={index}
                                    data={kpi}
                                    delay={index * 100}
                                    onDetailClick={() => onEnterPresentation(kpi.targetSlide)}
                                />
                            ))}
                        </div>

                        {/* Charts & Insights */}
                        <div className="grid grid-cols-1 lg:grid-cols-5 gap-6 mb-8 md:mb-12">
                            <div className="lg:col-span-3">
                                <CategoryChartCard data={schoolData.categoryData} academicYear={schoolData.academicYear} />
                            </div>
                            <div className="lg:col-span-2">
                                <PremiumAiInsightsPanel 
                                    aiInsights={schoolData.aiInsights}
                                    voices={schoolData.voices}
                                />
                            </div>
                        </div>

                        {/* Respondents Overview */}
                        <div className="glass-white rounded-3xl p-6 md:p-8 fade-in-up" style={{ animationDelay: '500ms' }}>
                            <h3 className="text-xl md:text-2xl font-bold text-gray-900 mb-6 md:mb-8">ÏùëÎãµÏûê Íµ¨ÏÑ±</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                                <div className="w-full max-w-sm mx-auto h-64 md:h-auto">
                                    <PremiumPieChart data={schoolData.respondentData} />
                                </div>
                                <div className="space-y-4">
                                    {schoolData.respondentData.map((item, index) => (
                                        <div key={index} className="flex items-center justify-between p-4 bg-gradient-to-r from-gray-50 to-white rounded-xl">
                                            <div className="flex items-center gap-3 md:gap-4">
                                                <div 
                                                    className="w-3 h-3 md:w-4 md:h-4 rounded-full shadow-lg"
                                                    style={{ backgroundColor: item.color }}
                                                ></div>
                                                <span className="font-semibold text-gray-800 text-sm md:text-base">{item.name}</span>
                                            </div>
                                            <div className="flex items-center gap-3 md:gap-4">
                                                <span className="text-xs font-semibold text-gray-500 bg-gray-100 px-2 py-1 rounded-md">
                                                    ÏùëÎãµÎ•† {getResponseRate(item.name)}%
                                                </span>
                                                <span className="text-xl md:text-3xl font-black text-gray-900 number-counter">
                                                    {item.value.toLocaleString()}
                                                    <span className="text-sm md:text-lg text-gray-500 ml-1">Î™Ö</span>
                                                </span>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </main>
                </div>
            );
        };

        // ============================================
        // PRESENTATION SLIDES
        // ============================================

        const SlideWrapper = ({ children, className = '' }) => (
            <div className={`presentation-content-wrapper p-4 md:p-12 ${className}`}>
                {children}
            </div>
        );

        // Slide 0: Title Slide
        const TitleSlide = ({ schoolData }) => {
            const totalParticipants = schoolData.kpiData.find(k => k.title === 'Ï¥ù Ï∞∏Ïó¨ Ïù∏Ïõê')?.value || 0;
            return (
                <SlideWrapper className="text-center">
                    <div className="zoom-in w-full max-w-4xl mx-auto flex flex-col items-center">
                        <div className="inline-block p-6 md:p-10 bg-white/10 backdrop-blur-xl rounded-3xl border border-white/20 mb-8 md:mb-12 float glow">
                            <div className="w-24 h-24 md:w-40 md:h-40 text-white">
                                <SchoolIcon />
                            </div>
                        </div>
                        <h1 className="display-1 text-white mb-4 md:mb-8">
                            {schoolData.academicYear} ÌïôÍµê ÌèâÍ∞Ä
                        </h1>
                        <p className="text-3xl md:text-6xl text-white/90 font-bold mb-4 md:mb-6 fade-in-up stagger-2">
                            <span className="text-yellow-300">{totalParticipants.toLocaleString()}</span>Î™ÖÏùò Ïù¥ÏïºÍ∏∞
                        </p>
                        <p className="text-2xl md:text-4xl text-white/70 font-medium mb-8 fade-in-up stagger-3">
                            {schoolData.semester} Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏
                        </p>
                        <div className="flex items-center justify-center gap-4 md:gap-6 text-white/70 text-xl md:text-3xl fade-in-up stagger-4">
                            <span className="sparkle">‚ú®</span>
                            <span>Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞ò Ïù∏ÏÇ¨Ïù¥Ìä∏</span>
                            <span className="sparkle">‚ú®</span>
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 1: Overall Score Slide
        const OverallScoreSlide = ({ schoolData }) => {
            const overallKpi = schoolData.kpiData.find(k => k.title === 'Ï¢ÖÌï© ÎßåÏ°±ÎèÑ');
            const score = useCountUp(overallKpi.value, 0, 2500, 2);
            const percentage = useCountUp((overallKpi.value / overallKpi.total) * 100, 0, 2500, 1);
            
            return (
                <SlideWrapper className="text-center">
                    <div className="fade-in-scale w-full max-w-4xl mx-auto flex flex-col items-center">
                        <p className="text-2xl md:text-4xl text-white/70 font-semibold mb-6 md:mb-10">‚≠ê Ï¢ÖÌï© ÎßåÏ°±ÎèÑ ‚≠ê</p>
                        <div className="mb-8 md:mb-16">
                            <span className="display-1 text-white number-counter font-black glow" style={{textShadow: '0 0 60px rgba(255,255,255,0.5)'}}>
                                {score.toFixed(2)}
                            </span>
                            <span className="text-4xl md:text-7xl text-white/50 font-bold">
                                /{overallKpi.total.toFixed(1)}
                            </span>
                        </div>
                        <div className="w-full max-w-4xl mx-auto mb-8 md:mb-12 px-4">
                            <div className="h-6 md:h-10 bg-white/20 rounded-full overflow-hidden backdrop-blur-xl shadow-2xl">
                                <div 
                                    className="h-full bg-gradient-to-r from-green-400 via-emerald-400 to-teal-500 rounded-full progress-animate"
                                    style={{ width: `${percentage}%` }}
                                ></div>
                            </div>
                            <p className="text-2xl md:text-4xl text-white/80 mt-4 md:mt-6 font-bold">{percentage.toFixed(1)}% Îã¨ÏÑ±</p>
                        </div>
                        <div className={`inline-block px-6 py-4 md:px-12 md:py-6 backdrop-blur-xl rounded-3xl border-2 slide-up-bounce ${overallKpi.change >= 0 ? 'bg-green-500/20 border-green-400/50' : 'bg-orange-500/20 border-orange-400/50'}`}>
                            <p className={`text-xl md:text-4xl font-bold ${overallKpi.change >= 0 ? 'text-green-300' : 'text-orange-300'}`}>
                                {overallKpi.change >= 0 ? 'üìà ‚ñ≤' : 'üìâ ‚ñº'} Ï†ÑÎÖÑ ÎåÄÎπÑ {overallKpi.change >= 0 ? '+' : ''}{overallKpi.change.toFixed(2)}Ï†ê
                            </p>
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 2: Participants Slide
        const ParticipantsSlide = ({ schoolData }) => {
            const total = schoolData.respondentData.reduce((sum, item) => sum + item.value, 0);
            
            return (
                <SlideWrapper className="text-center">
                    <div className="w-full max-w-6xl fade-in-scale flex flex-col items-center">
                        <h2 className="text-3xl md:text-6xl font-bold text-white mb-8 md:mb-16">üë• ÏùëÎãµÏûê Íµ¨ÏÑ±</h2>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-16 items-center w-full">
                            <div className="flex items-center justify-center zoom-in w-full">
                                <div className="w-64 h-64 md:w-96 md:h-96">
                                    <PremiumPieChart data={schoolData.respondentData} />
                                </div>
                            </div>
                            <div className="space-y-4 md:space-y-6 text-left w-full">
                                {schoolData.respondentData.map((d, index) => (
                                    <div 
                                        key={index} 
                                        className={`flex items-center justify-between p-4 md:p-6 bg-white/10 backdrop-blur-xl rounded-2xl border border-white/20 slide-up-bounce card-3d`}
                                        style={{ animationDelay: `${index * 150}ms` }}
                                    >
                                        <div className="flex items-center gap-3 md:gap-4">
                                            <div 
                                                className="w-4 h-4 md:w-8 md:h-8 rounded-full shadow-lg"
                                                style={{ backgroundColor: d.color }}
                                            ></div>
                                            <span className="text-xl md:text-3xl font-bold text-white">{d.name}</span>
                                        </div>
                                        <span className="text-2xl md:text-5xl font-black text-white number-counter">
                                            {d.value.toLocaleString()}
                                            <span className="text-sm md:text-2xl text-white/70 ml-2">Î™Ö</span>
                                        </span>
                                    </div>
                                ))}
                                <div className="mt-4 md:mt-8 p-4 md:p-6 bg-gradient-to-r from-indigo-500/30 to-purple-500/30 rounded-2xl border border-indigo-400/30 fade-in-up stagger-5">
                                    <p className="text-xl md:text-3xl text-white font-bold text-center">
                                        Ï¥ù <span className="text-3xl md:text-5xl text-yellow-300">{total.toLocaleString()}</span>Î™Ö Ï∞∏Ïó¨ üéâ
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 3: Response Rate Slide
        const ResponseRateSlide = ({ schoolData }) => {
            const { responseRates, respondentData } = schoolData;
            
            const groups = [
                { id: 'teacher', name: 'ÍµêÏõê', color: '#6366F1', icon: 'üë®‚Äçüè´' },
                { id: 'student', name: 'ÌïôÏÉù', color: '#EC4899', icon: 'üéì' },
                { id: 'parent', name: 'ÌïôÎ∂ÄÎ™®', color: '#10B981', icon: 'üë™' },
                { id: 'staff', name: 'ÏßÅÏõê', color: '#F59E0B', icon: 'üíº' }
            ];

            return (
                <SlideWrapper className="text-center">
                    <div className="w-full max-w-6xl fade-in-up">
                        <h2 className="text-3xl md:text-6xl font-bold text-white mb-8 md:mb-16">üìä Í∑∏Î£πÎ≥Ñ Ïã§Ï†ú ÏùëÎãµÎ•†</h2>
                        
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-8">
                            {groups.map((group, index) => {
                                const rate = responseRates[group.id] || 0;
                                const animatedRate = useCountUp(rate, 0, 1500, 1);
                                
                                return (
                                    <div 
                                        key={group.id}
                                        className="bg-white/10 backdrop-blur-xl rounded-3xl p-6 md:p-8 border border-white/20 slide-up-bounce card-3d"
                                        style={{ animationDelay: `${index * 150}ms` }}
                                    >
                                        <div className="flex items-center justify-between mb-4 md:mb-6">
                                            <div className="flex items-center gap-3 md:gap-4">
                                                <span className="text-2xl md:text-4xl">{group.icon}</span>
                                                <h3 className="text-2xl md:text-3xl font-bold text-white">{group.name}</h3>
                                            </div>
                                            <span className="text-3xl md:text-5xl font-black text-white number-counter">
                                                {animatedRate.toFixed(1)}%
                                            </span>
                                        </div>
                                        
                                        <div className="h-4 md:h-6 bg-white/20 rounded-full overflow-hidden mb-2">
                                            <div 
                                                className="h-full rounded-full progress-animate relative"
                                                style={{ 
                                                    width: `${Math.min(rate, 100)}%`,
                                                    backgroundColor: group.color 
                                                }}
                                            >
                                                <div className="absolute inset-0 bg-white/30 animate-pulse"></div>
                                            </div>
                                        </div>
                                        <p className="text-right text-white/60 text-sm md:text-lg">
                                            ÏùëÎãµ ÏôÑÎ£å
                                        </p>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 4: Category Change Slide
        const CategoryChangeSlide = ({ schoolData }) => {
            const { categoryData, academicYear } = schoolData;
            const prevYear = String(parseInt(academicYear) - 1);
            
            return (
                <SlideWrapper className="text-center">
                    <div className="w-full max-w-6xl fade-in-scale">
                        <h2 className="text-3xl md:text-5xl font-bold text-white mb-8 md:mb-12">üìä Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ ÎßåÏ°±ÎèÑ Î≥ÄÌôî</h2>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-5">
                            {categoryData.map((cat, idx) => {
                                const currentScore = cat[academicYear] || cat['2025'] || 0;
                                const prevScore = cat[prevYear] || cat['2024'] || 0;
                                const change = (currentScore - prevScore).toFixed(2);
                                const isPositive = parseFloat(change) >= 0;
                                return (
                                    <div 
                                        key={idx} 
                                        className={`bg-white/10 backdrop-blur-xl rounded-2xl p-4 md:p-5 border border-white/20 slide-up-bounce card-3d`}
                                        style={{ animationDelay: `${idx * 100}ms` }}
                                    >
                                        <div className="flex justify-between items-center mb-2 md:mb-0">
                                            <p className="text-base md:text-xl text-white font-semibold text-left">{cat.name}</p>
                                            <div className="flex items-center gap-2 md:gap-4 shrink-0">
                                                <span className="text-white/60 text-sm md:text-lg">{prevScore.toFixed(2)}</span>
                                                <span className="text-white/40 text-lg md:text-2xl">‚Üí</span>
                                                <span className="text-xl md:text-3xl font-bold text-white">{currentScore.toFixed(2)}</span>
                                                <span className={`text-xs md:text-lg px-2 py-1 md:px-3 rounded-full ${isPositive ? 'bg-green-500/30 text-green-300' : 'bg-red-500/30 text-red-300'}`}>
                                                    {isPositive ? '+' : ''}{change}
                                                </span>
                                            </div>
                                        </div>
                                        <div className="mt-2 md:mt-4 h-2 md:h-3 bg-white/20 rounded-full overflow-hidden">
                                            <div 
                                                className="h-full bg-gradient-to-r from-indigo-400 to-purple-500 rounded-full progress-animate"
                                                style={{ width: `${(currentScore / 5) * 100}%` }}
                                            ></div>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 5: Group Comparison Slide
        const ComparisonSlide = ({ schoolData }) => {
            const { comparisonData } = schoolData;
            
            const groups = [
                { key: 'teacher', name: 'ÍµêÏõê', color: '#6366F1', data: comparisonData.teacher },
                { key: 'student', name: 'ÌïôÏÉù', color: '#EC4899', data: comparisonData.student },
                { key: 'parent', name: 'ÌïôÎ∂ÄÎ™®', color: '#10B981', data: comparisonData.parent },
                { key: 'staff', name: 'ÏßÅÏõê', color: '#F59E0B', data: comparisonData.staff },
            ];
            
            return (
                <SlideWrapper className="text-center">
                    <div className="w-full max-w-6xl fade-in-scale">
                        <h2 className="text-3xl md:text-5xl font-bold text-white mb-8 md:mb-12">üèÖ Í∑∏Î£πÎ≥Ñ ÎßåÏ°±ÎèÑ ÎπÑÍµê</h2>
                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
                            {groups.map((group, idx) => (
                                <div 
                                    key={idx}
                                    className={`bg-white/10 backdrop-blur-xl rounded-3xl p-6 border border-white/20 flip-in`}
                                    style={{ animationDelay: `${idx * 150}ms` }}
                                >
                                    <div className="flex items-center gap-3 mb-4 md:mb-6 justify-center md:justify-start">
                                        <div className="w-5 h-5 rounded-full" style={{ backgroundColor: group.color }}></div>
                                        <h3 className="text-xl md:text-2xl font-bold text-white">{group.name}</h3>
                                    </div>
                                    <div className="text-center mb-4 md:mb-6">
                                        <p className="text-4xl md:text-6xl font-black text-white number-counter glow">{group.data.average.toFixed(2)}</p>
                                        <p className="text-sm md:text-lg text-white/60 mt-2">ÌèâÍ∑† Ï†êÏàò</p>
                                    </div>
                                    <div className="space-y-3">
                                        <div className="bg-green-500/20 p-3 rounded-xl">
                                            <p className="text-xs md:text-sm text-white/60">ÏµúÍ≥†Ï†ê</p>
                                            <p className="text-xl md:text-2xl font-bold text-green-300">{group.data.highest.toFixed(2)}</p>
                                        </div>
                                        <div className="bg-orange-500/20 p-3 rounded-xl">
                                            <p className="text-xs md:text-sm text-white/60">ÏµúÏ†ÄÏ†ê</p>
                                            <p className="text-xl md:text-2xl font-bold text-orange-300">{group.data.lowest.toFixed(2)}</p>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 6: Top Items Slide (ÍµêÏõê)
        const TopItemsTeacherSlide = ({ schoolData }) => {
            const { topBottomItems } = schoolData;
            
            return (
                <SlideWrapper className="text-center">
                    <div className="w-full max-w-5xl fade-in-scale">
                        <h2 className="text-3xl md:text-5xl font-bold text-white mb-2 md:mb-4">üèÜ TOP 3 Ìï≠Î™© (ÍµêÏõê)</h2>
                        <p className="text-lg md:text-2xl text-white/60 mb-8 md:mb-12">Í∞ÄÏû• ÎÜíÏùÄ ÎßåÏ°±ÎèÑÎ•º Í∏∞Î°ùÌïú Ìï≠Î™©</p>
                        <div className="space-y-4 md:space-y-6">
                            {topBottomItems.teacherTop.length > 0 ? topBottomItems.teacherTop.map((item, idx) => (
                                <div 
                                    key={idx}
                                    className={`bg-gradient-to-r from-green-500/20 to-emerald-500/20 backdrop-blur-xl rounded-2xl p-4 md:p-8 border border-green-400/30 slide-in-right`}
                                    style={{ animationDelay: `${idx * 200}ms` }}
                                >
                                    <div className="flex flex-col md:flex-row items-center md:items-center justify-between gap-4 md:gap-6">
                                        <div className="flex items-start md:items-center gap-4 md:gap-6 w-full md:w-auto">
                                            <span className="text-3xl md:text-5xl">{idx === 0 ? 'ü•á' : idx === 1 ? 'ü•à' : 'ü•â'}</span>
                                            <p className="text-lg md:text-2xl text-white/90 text-left flex-1">{item.title}</p>
                                        </div>
                                        <span className="text-3xl md:text-4xl font-black text-green-300 whitespace-nowrap self-end md:self-auto">{item.score}</span>
                                    </div>
                                </div>
                            )) : (
                                <div className="text-center text-white/60 py-12">
                                    <p className="text-2xl">Îç∞Ïù¥ÌÑ∞Î•º ÏóÖÎ°úÎìúÌïòÎ©¥ Í≤∞Í≥ºÍ∞Ä ÌëúÏãúÎê©ÎãàÎã§.</p>
                                </div>
                            )}
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 7: Top Items Slide (ÌïôÏÉù)
        const TopItemsStudentSlide = ({ schoolData }) => {
            const { topBottomItems } = schoolData;
            
            return (
                <SlideWrapper className="text-center">
                    <div className="w-full max-w-5xl fade-in-scale">
                        <h2 className="text-3xl md:text-5xl font-bold text-white mb-2 md:mb-4">üèÜ TOP 3 Ìï≠Î™© (ÌïôÏÉù)</h2>
                        <p className="text-lg md:text-2xl text-white/60 mb-8 md:mb-12">ÌïôÏÉùÎì§Ïù¥ Í∞ÄÏû• ÎßåÏ°±Ìïú Ìï≠Î™©</p>
                        <div className="space-y-4 md:space-y-6">
                            {topBottomItems.studentTop.length > 0 ? topBottomItems.studentTop.map((item, idx) => (
                                <div 
                                    key={idx}
                                    className={`bg-gradient-to-r from-green-500/20 to-emerald-500/20 backdrop-blur-xl rounded-2xl p-4 md:p-8 border border-green-400/30 slide-in-right`}
                                    style={{ animationDelay: `${idx * 200}ms` }}
                                >
                                    <div className="flex flex-col md:flex-row items-center justify-between gap-4 md:gap-6">
                                        <div className="flex items-start md:items-center gap-4 md:gap-6 w-full md:w-auto">
                                            <span className="text-3xl md:text-5xl">{idx === 0 ? 'ü•á' : idx === 1 ? 'ü•à' : 'ü•â'}</span>
                                            <p className="text-lg md:text-2xl text-white/90 text-left flex-1">{item.title}</p>
                                        </div>
                                        <span className="text-3xl md:text-4xl font-black text-green-300 whitespace-nowrap self-end md:self-auto">{item.score}</span>
                                    </div>
                                </div>
                            )) : (
                                <div className="text-center text-white/60 py-12">
                                    <p className="text-2xl">Îç∞Ïù¥ÌÑ∞Î•º ÏóÖÎ°úÎìúÌïòÎ©¥ Í≤∞Í≥ºÍ∞Ä ÌëúÏãúÎê©ÎãàÎã§.</p>
                                </div>
                            )}
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 8: Improvement Items Slide (ÍµêÏõê)
        const ImprovementTeacherSlide = ({ schoolData }) => {
            const { topBottomItems } = schoolData;
            
            return (
                <SlideWrapper className="text-center">
                    <div className="w-full max-w-5xl fade-in-scale">
                        <h2 className="text-3xl md:text-5xl font-bold text-white mb-2 md:mb-4">‚ö†Ô∏è Í∞úÏÑ† ÌïÑÏöî Ìï≠Î™© (ÍµêÏõê)</h2>
                        <p className="text-lg md:text-2xl text-white/60 mb-8 md:mb-12">ÍµêÏõêÏù¥ Í∞ÄÏû• ÎÇÆÍ≤å ÌèâÍ∞ÄÌïú ÏòÅÏó≠</p>
                        <div className="space-y-4 md:space-y-6">
                            {topBottomItems.teacherBottom.length > 0 ? topBottomItems.teacherBottom.map((item, idx) => (
                                <div 
                                    key={idx}
                                    className={`bg-gradient-to-r from-red-500/20 to-pink-500/20 backdrop-blur-xl rounded-2xl p-4 md:p-8 border border-red-400/30 slide-in-right`}
                                    style={{ animationDelay: `${idx * 200}ms` }}
                                >
                                    <div className="flex flex-col md:flex-row items-center justify-between gap-4 md:gap-6">
                                        <div className="flex items-start md:items-center gap-4 md:gap-6 w-full md:w-auto">
                                            <span className="text-3xl md:text-5xl">üëé</span>
                                            <p className="text-lg md:text-2xl text-white/90 text-left flex-1">{item.title}</p>
                                        </div>
                                        <span className="text-3xl md:text-4xl font-black text-red-300 whitespace-nowrap self-end md:self-auto">{item.score}</span>
                                    </div>
                                </div>
                            )) : (
                                <div className="text-center text-white/60 py-12">
                                    <p className="text-2xl">Îç∞Ïù¥ÌÑ∞Î•º ÏóÖÎ°úÎìúÌïòÎ©¥ Í≤∞Í≥ºÍ∞Ä ÌëúÏãúÎê©ÎãàÎã§.</p>
                                </div>
                            )}
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 9: Improvement Items Slide (ÌïôÏÉù)
        const ImprovementStudentSlide = ({ schoolData }) => {
            const { topBottomItems } = schoolData;
            
            return (
                <SlideWrapper className="text-center">
                    <div className="w-full max-w-5xl fade-in-scale">
                        <h2 className="text-3xl md:text-5xl font-bold text-white mb-2 md:mb-4">‚ö†Ô∏è Í∞úÏÑ† ÌïÑÏöî Ìï≠Î™© (ÌïôÏÉù)</h2>
                        <p className="text-lg md:text-2xl text-white/60 mb-8 md:mb-12">ÌïôÏÉùÏù¥ Í∞ÄÏû• ÎÇÆÍ≤å ÌèâÍ∞ÄÌïú ÏòÅÏó≠</p>
                        <div className="space-y-4 md:space-y-6">
                            {topBottomItems.studentBottom.length > 0 ? topBottomItems.studentBottom.map((item, idx) => (
                                <div 
                                    key={idx}
                                    className={`bg-gradient-to-r from-red-500/20 to-pink-500/20 backdrop-blur-xl rounded-2xl p-4 md:p-8 border border-red-400/30 slide-in-right`}
                                    style={{ animationDelay: `${idx * 200}ms` }}
                                >
                                    <div className="flex flex-col md:flex-row items-center justify-between gap-4 md:gap-6">
                                        <div className="flex items-start md:items-center gap-4 md:gap-6 w-full md:w-auto">
                                            <span className="text-3xl md:text-5xl">üòü</span>
                                            <p className="text-lg md:text-2xl text-white/90 text-left flex-1">{item.title}</p>
                                        </div>
                                        <span className="text-3xl md:text-4xl font-black text-red-300 whitespace-nowrap self-end md:self-auto">{item.score}</span>
                                    </div>
                                </div>
                            )) : (
                                <div className="text-center text-white/60 py-12">
                                    <p className="text-2xl">Îç∞Ïù¥ÌÑ∞Î•º ÏóÖÎ°úÎìúÌïòÎ©¥ Í≤∞Í≥ºÍ∞Ä ÌëúÏãúÎê©ÎãàÎã§.</p>
                                </div>
                            )}
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 10: Trend Slide
        const TrendSlide = ({ schoolData }) => {
            const { trendData } = schoolData;
            
            return (
                <SlideWrapper className="text-center">
                    <div className="w-full max-w-6xl fade-in-scale">
                        <h2 className="text-3xl md:text-5xl font-bold text-white mb-8 md:mb-12">üìà Ïó∞ÎèÑÎ≥Ñ ÎßåÏ°±ÎèÑ Ï∂îÏù¥</h2>
                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
                            {trendData.map((data, idx) => (
                                <div 
                                    key={idx} 
                                    className={`bg-white/10 backdrop-blur-xl rounded-3xl p-6 border border-white/20 rotate-in card-3d`}
                                    style={{ animationDelay: `${idx * 150}ms` }}
                                >
                                    <p className="text-3xl md:text-4xl font-black text-white mb-4 md:mb-6">{data.year}</p>
                                    <div className="space-y-3 md:space-y-4">
                                        <div className="bg-indigo-500/20 p-2 md:p-3 rounded-xl">
                                            <p className="text-xs md:text-sm text-indigo-300">ÍµêÏõê</p>
                                            <p className="text-xl md:text-2xl font-bold text-white">{data.teacher.toFixed(2)}</p>
                                        </div>
                                        <div className="bg-pink-500/20 p-2 md:p-3 rounded-xl">
                                            <p className="text-xs md:text-sm text-pink-300">ÌïôÏÉù</p>
                                            <p className="text-xl md:text-2xl font-bold text-white">{data.student.toFixed(2)}</p>
                                        </div>
                                        <div className="bg-emerald-500/20 p-2 md:p-3 rounded-xl">
                                            <p className="text-xs md:text-sm text-emerald-300">ÌïôÎ∂ÄÎ™®</p>
                                            <p className="text-xl md:text-2xl font-bold text-white">{data.parent.toFixed(2)}</p>
                                        </div>
                                        <div className="bg-amber-500/20 p-2 md:p-3 rounded-xl">
                                            <p className="text-xs md:text-sm text-amber-300">ÏßÅÏõê</p>
                                            <p className="text-xl md:text-2xl font-bold text-white">{data.staff.toFixed(2)}</p>
                                        </div>
                                        <div className="pt-3 border-t border-white/20">
                                            <p className="text-sm text-white/60">ÌèâÍ∑†</p>
                                            <p className="text-2xl md:text-3xl font-black text-yellow-300">{data.overall.toFixed(2)}</p>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 11: Trend Line Chart Slide
        const TrendBarChartSlide = ({ schoolData }) => {
            const canvasRef = useRef(null);
            const chartRef = useRef(null);
            const { trendData } = schoolData;

            useEffect(() => {
                if (canvasRef.current && trendData.length > 0) {
                    const ctx = canvasRef.current.getContext('2d');
                    
                    if (chartRef.current) {
                        chartRef.current.destroy();
                    }

                    chartRef.current = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: trendData.map(d => d.year + 'ÎÖÑ'),
                            datasets: [
                                {
                                    label: 'ÍµêÏõê',
                                    data: trendData.map(d => d.teacher),
                                    borderColor: 'rgba(99, 102, 241, 1)',
                                    backgroundColor: 'rgba(99, 102, 241, 0.2)',
                                    borderWidth: 4,
                                    pointRadius: 6,
                                    tension: 0.3,
                                },
                                {
                                    label: 'ÌïôÏÉù',
                                    data: trendData.map(d => d.student),
                                    borderColor: 'rgba(236, 72, 153, 1)',
                                    backgroundColor: 'rgba(236, 72, 153, 0.2)',
                                    borderWidth: 4,
                                    pointRadius: 6,
                                    tension: 0.3,
                                },
                                {
                                    label: 'ÌïôÎ∂ÄÎ™®',
                                    data: trendData.map(d => d.parent),
                                    borderColor: 'rgba(16, 185, 129, 1)',
                                    backgroundColor: 'rgba(16, 185, 129, 0.2)',
                                    borderWidth: 4,
                                    pointRadius: 6,
                                    tension: 0.3,
                                },
                                {
                                    label: 'ÏßÅÏõê',
                                    data: trendData.map(d => d.staff),
                                    borderColor: 'rgba(245, 158, 11, 1)',
                                    backgroundColor: 'rgba(245, 158, 11, 0.2)',
                                    borderWidth: 4,
                                    pointRadius: 6,
                                    tension: 0.3,
                                },
                                {
                                    label: 'ÌèâÍ∑†',
                                    data: trendData.map(d => d.overall),
                                    borderColor: 'rgba(139, 92, 246, 1)',
                                    backgroundColor: 'rgba(139, 92, 246, 0.2)',
                                    borderWidth: 5,
                                    pointRadius: 8,
                                    tension: 0.3,
                                    borderDash: [],
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        color: 'rgba(255, 255, 255, 0.9)',
                                        usePointStyle: true,
                                        boxWidth: 8,
                                        font: { size: 12, weight: '600' }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: false,
                                    min: 3.0,
                                    max: 5.0,
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { color: 'rgba(255, 255, 255, 0.8)' }
                                },
                                x: {
                                    grid: { color: 'rgba(255, 255, 255, 0.05)' },
                                    ticks: { color: 'rgba(255, 255, 255, 0.9)' }
                                }
                            }
                        }
                    });
                }

                return () => {
                    if (chartRef.current) {
                        chartRef.current.destroy();
                    }
                };
            }, [trendData]);

            return (
                <SlideWrapper className="text-center">
                    <div className="w-full max-w-6xl fade-in-scale">
                        <h2 className="text-3xl md:text-5xl font-bold text-white mb-4">üìà Ïó∞ÎèÑÎ≥Ñ ÎßåÏ°±ÎèÑ Ï∂îÏù¥ Í∑∏ÎûòÌîÑ</h2>
                        <p className="text-lg md:text-2xl text-white/60 mb-6 md:mb-10">Í∑∏Î£πÎ≥Ñ Ïó∞ÎèÑÎ≥Ñ ÎßåÏ°±ÎèÑ Î≥ÄÌôî</p>
                        <div className="bg-white/10 backdrop-blur-xl rounded-3xl p-4 md:p-8 border border-white/20 h-64 md:h-[500px]">
                            <canvas ref={canvasRef}></canvas>
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 12: Insights Slide
        const InsightsSlide = ({ schoolData }) => {
            const { aiInsights } = schoolData;
            
            const getTypeStyle = (type) => {
                switch(type) {
                    case 'achievement': return 'from-green-500/20 to-emerald-500/20 border-green-400/30';
                    case 'improvement': return 'from-red-500/20 to-pink-500/20 border-red-400/30';
                    case 'action': return 'from-purple-500/20 to-pink-500/20 border-purple-400/30';
                    default: return 'from-blue-500/20 to-cyan-500/20 border-blue-400/30';
                }
            };
            
            return (
                <SlideWrapper className="text-center">
                    <div className="w-full max-w-5xl fade-in-scale">
                        <h2 className="text-3xl md:text-5xl font-bold text-white mb-8 md:mb-12">ü§ñ AI ÌïµÏã¨ Ïù∏ÏÇ¨Ïù¥Ìä∏</h2>
                        <div className="space-y-4 md:space-y-5 text-left">
                            {aiInsights.length > 0 ? aiInsights.map((insight, idx) => (
                                <div 
                                    key={idx}
                                    className={`bg-gradient-to-r ${getTypeStyle(insight.type)} backdrop-blur-xl rounded-2xl p-4 md:p-6 border slide-up-bounce`}
                                    style={{ animationDelay: `${idx * 150}ms` }}
                                >
                                    <h3 className="text-lg md:text-2xl font-bold text-white mb-2">{insight.title}</h3>
                                    <p className="text-base md:text-xl text-white/80">{insight.content}</p>
                                </div>
                            )) : (
                                <div className="text-center text-white/60 py-12">
                                    <p className="text-2xl">Îç∞Ïù¥ÌÑ∞Î•º ÏóÖÎ°úÎìúÌïòÎ©¥ AI Ïù∏ÏÇ¨Ïù¥Ìä∏Í∞Ä ÏÉùÏÑ±Îê©ÎãàÎã§.</p>
                                </div>
                            )}
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 13: Action Items Slide
        const ActionItemsSlide = ({ schoolData }) => {
            const { actionItems } = schoolData;
            
            return (
                <SlideWrapper className="text-center">
                    <div className="w-full max-w-6xl fade-in-up">
                        <h2 className="text-3xl md:text-5xl font-bold text-white mb-8">üéØ ÌïµÏã¨ Ïã§Ìñâ Í≥ºÏ†ú</h2>
                        <div className="space-y-4 md:space-y-5 text-left">
                            {actionItems.length > 0 ? actionItems.map((item, index) => (
                                <div 
                                    key={index}
                                    className={`bg-white/95 backdrop-blur-xl rounded-3xl p-4 md:p-6 shadow-2xl flip-in`}
                                    style={{ animationDelay: `${index * 200}ms` }}
                                >
                                    <div className="flex flex-col md:flex-row items-center md:items-start gap-4 md:gap-6">
                                        <div className="w-16 h-16 md:w-20 md:h-20 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-3xl md:text-4xl shadow-lg bounce shrink-0">
                                            {item.icon}
                                        </div>
                                        <div className="flex-1 w-full">
                                            <div className="flex flex-col md:flex-row items-center md:items-center gap-2 md:gap-4 mb-3 md:mb-4">
                                                <span className="px-3 py-1 md:px-5 md:py-2 bg-indigo-600 text-white rounded-full text-sm md:text-lg font-bold shadow-md">
                                                    Ïö∞ÏÑ†ÏàúÏúÑ {item.priority}
                                                </span>
                                                <h3 className="text-xl md:text-3xl font-bold text-gray-900">{item.title}</h3>
                                            </div>
                                            <ul className="flex flex-wrap gap-2 md:gap-3">
                                                {item.details.map((detail, i) => (
                                                    <li key={i} className="flex items-center gap-2 bg-indigo-50 border-2 border-indigo-100 px-3 py-1 md:px-5 md:py-2 rounded-full text-sm md:text-lg font-semibold text-indigo-900">
                                                        <span className="text-indigo-600 font-bold">‚úì</span>
                                                        <span>{detail}</span>
                                                    </li>
                                                ))}
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            )) : (
                                <div className="text-center text-white/60 py-12">
                                    <p className="text-2xl">Îç∞Ïù¥ÌÑ∞Î•º ÏóÖÎ°úÎìúÌïòÎ©¥ Ïã§Ìñâ Í≥ºÏ†úÍ∞Ä ÏÉùÏÑ±Îê©ÎãàÎã§.</p>
                                </div>
                            )}
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 14: Roadmap Slide
        const RoadmapSlide = ({ schoolData }) => (
            <SlideWrapper className="text-center">
                <div className="w-full max-w-6xl fade-in-up">
                    <h2 className="text-3xl md:text-5xl font-bold text-white mb-8 md:mb-16">üó∫Ô∏è {parseInt(schoolData.academicYear) + 1} Ïã§Ìñâ Î°úÎìúÎßµ</h2>
                    <div className="relative">
                        <div className="hidden md:block absolute top-1/2 left-0 right-0 h-2 bg-white/20 rounded-full"></div>
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-6 md:gap-8 relative">
                            {schoolData.roadmap.map((item, index) => (
                                <div 
                                    key={index} 
                                    className={`text-center slide-up-bounce flex flex-col items-center`}
                                    style={{ animationDelay: `${index * 200}ms` }}
                                >
                                    <div className="mb-4 md:mb-8 order-1 md:order-1">
                                        <div 
                                            className={`w-16 h-16 md:w-20 md:h-20 mx-auto rounded-full border-4 border-white shadow-2xl glow wave-${index + 1}`}
                                            style={{ backgroundColor: item.color }}
                                        ></div>
                                    </div>
                                    <div className="bg-white/95 backdrop-blur-xl rounded-3xl p-4 md:p-6 shadow-xl card-3d w-full order-2 md:order-2">
                                        <div className="text-xl md:text-3xl font-black text-gray-900 mb-1 md:mb-2">{item.quarter}</div>
                                        <div className="text-sm md:text-lg text-gray-500 mb-2 md:mb-4">{item.period}</div>
                                        <div className="text-base md:text-lg font-semibold text-gray-700">{item.task}</div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            </SlideWrapper>
        );

        // Slide 15: Goal Slide
        const GoalSlide = ({ schoolData }) => {
            const { goal } = schoolData;
            const currentScore = useCountUp(goal.currentScore, 0, 2000, 2);
            const targetScore = useCountUp(goal.targetScore, 0, 2500, 2);
            
            return (
                <SlideWrapper className="text-center">
                    <div className="w-full max-w-5xl zoom-in">
                        <h2 className="text-3xl md:text-6xl font-bold text-white mb-8 md:mb-16">üéØ {parseInt(schoolData.academicYear) + 1} Î™©Ìëú</h2>
                        <div className="bg-white/10 backdrop-blur-xl rounded-3xl p-6 md:p-16 border border-white/20">
                            <p className="text-2xl md:text-4xl text-white/70 font-semibold mb-8 md:mb-12 text-center">Ï¢ÖÌï© ÎßåÏ°±ÎèÑ</p>
                            <div className="flex flex-col md:flex-row items-center justify-center gap-8 md:gap-16">
                                <div className="text-center">
                                    <p className="text-lg md:text-2xl text-white/60 mb-2 md:mb-4">ÌòÑÏû¨</p>
                                    <span className="text-6xl md:text-8xl font-black text-white number-counter">{currentScore.toFixed(2)}</span>
                                </div>
                                <span className="text-6xl md:text-8xl text-white/50 bounce rotate-90 md:rotate-0">‚Üí</span>
                                <div className="text-center">
                                    <p className="text-lg md:text-2xl text-green-300 mb-2 md:mb-4">Î™©Ìëú</p>
                                    <span className="text-6xl md:text-8xl font-black text-green-400 number-counter glow">{targetScore.toFixed(2)}</span>
                                </div>
                            </div>
                            <div className="mt-8 md:mt-12 text-center">
                                <span className="inline-block px-4 py-3 md:px-8 md:py-4 bg-green-500/20 rounded-full text-xl md:text-3xl font-bold text-green-300 border border-green-400/30">
                                    üìà +{(goal.targetScore - goal.currentScore).toFixed(2)}Ï†ê ÏÉÅÏäπ Î™©Ìëú
                                </span>
                            </div>
                        </div>
                    </div>
                </SlideWrapper>
            );
        };

        // Slide 16: Closing Slide
        const ClosingSlide = ({ schoolData }) => (
            <SlideWrapper className="text-center">
                <div className="zoom-in">
                    <div className="inline-block p-8 md:p-12 bg-white/10 backdrop-blur-xl rounded-3xl border border-white/20 mb-8 md:mb-12 float glow">
                        <div className="w-32 h-32 md:w-48 md:h-48 text-white">
                            <SchoolIcon />
                        </div>
                    </div>
                    <h2 className="display-2 text-white mb-4 md:mb-8">Í∞êÏÇ¨Ìï©ÎãàÎã§</h2>
                    <p className="text-2xl md:text-4xl text-white/80 font-medium mb-2 md:mb-4">
                        Îçî ÎÇòÏùÄ <span className="text-yellow-300 font-bold">{schoolData.schoolName}</span>ÏùÑ ÏúÑÌï¥
                    </p>
                    <p className="text-2xl md:text-4xl text-white/80 font-medium mb-8 md:mb-12">
                        Ìï®Íªò ÎÇòÏïÑÍ∞ëÏãúÎã§
                    </p>
                    <div className="flex items-center justify-center gap-4 md:gap-6 text-4xl md:text-6xl fade-in-up stagger-3">
                        <span className="wave-1">üéì</span>
                        <span className="wave-2">üìö</span>
                        <span className="wave-3">üí™</span>
                        <span className="wave-4">üåü</span>
                    </div>
                </div>
            </SlideWrapper>
        );

        // Presentation Mode Component
        const PremiumPresentationMode = ({ schoolData, onExit, startSlide = 0 }) => {
            const [currentSlide, setCurrentSlide] = useState(startSlide);
            
            const slides = [
                <TitleSlide key={0} schoolData={schoolData} />,
                <OverallScoreSlide key={1} schoolData={schoolData} />,
                <ParticipantsSlide key={2} schoolData={schoolData} />,
                <ResponseRateSlide key={3} schoolData={schoolData} />,
                <CategoryChangeSlide key={4} schoolData={schoolData} />,
                <ComparisonSlide key={5} schoolData={schoolData} />,
                <TopItemsTeacherSlide key={6} schoolData={schoolData} />,
                <TopItemsStudentSlide key={7} schoolData={schoolData} />,
                <ImprovementTeacherSlide key={8} schoolData={schoolData} />,
                <ImprovementStudentSlide key={9} schoolData={schoolData} />,
                <TrendSlide key={10} schoolData={schoolData} />,
                <TrendBarChartSlide key={11} schoolData={schoolData} />,
                <InsightsSlide key={12} schoolData={schoolData} />,
                <ActionItemsSlide key={13} schoolData={schoolData} />,
                <RoadmapSlide key={14} schoolData={schoolData} />,
                <GoalSlide key={15} schoolData={schoolData} />,
                <ClosingSlide key={16} schoolData={schoolData} />,
            ];
            
            const totalSlides = slides.length;
            
            const goNext = () => {
                setCurrentSlide(prev => Math.min(prev + 1, totalSlides - 1));
            };
            
            const goPrev = () => {
                setCurrentSlide(prev => Math.max(prev - 1, 0));
            };
            
            useEffect(() => {
                const handleKey = (e) => {
                    if (e.key === 'ArrowRight' || e.key === ' ' || e.key === 'Enter') {
                        e.preventDefault();
                        goNext();
                    } else if (e.key === 'ArrowLeft') {
                        e.preventDefault();
                        goPrev();
                    } else if (e.key === 'Escape') {
                        e.preventDefault();
                        onExit();
                    }
                };
                
                window.addEventListener('keydown', handleKey);
                return () => window.removeEventListener('keydown', handleKey);
            }, [currentSlide]);
            
            return (
                <div className="fixed inset-0 presentation-slide z-50 bg-gray-900">
                    <div className="relative z-10 flex flex-col h-full">
                        <div className="flex-1 overflow-y-auto no-scrollbar">
                            {slides[currentSlide]}
                        </div>
                        <div className="p-4 md:p-6 bg-gradient-to-t from-black/50 to-transparent sticky bottom-0 z-20">
                            <div className="max-w-3xl mx-auto">
                                <div className="flex items-center justify-between mb-4">
                                    <span className="text-white/60 text-sm md:text-lg font-medium">
                                        {currentSlide + 1} / {totalSlides}
                                    </span>
                                    <div className="flex items-center gap-2 md:gap-4">
                                        <button 
                                            onClick={goPrev}
                                            disabled={currentSlide === 0}
                                            className="px-3 py-2 md:px-6 md:py-3 bg-white/20 hover:bg-white/30 disabled:opacity-30 text-white rounded-xl transition-all text-sm md:text-lg font-semibold"
                                        >
                                            ‚Üê <span className="hidden md:inline">Ïù¥Ï†Ñ</span>
                                        </button>
                                        <button 
                                            onClick={goNext}
                                            disabled={currentSlide === totalSlides - 1}
                                            className="px-3 py-2 md:px-6 md:py-3 bg-white/20 hover:bg-white/30 disabled:opacity-30 text-white rounded-xl transition-all text-sm md:text-lg font-semibold"
                                        >
                                            <span className="hidden md:inline">Îã§Ïùå</span> ‚Üí
                                        </button>
                                        <button 
                                            onClick={onExit}
                                            className="px-3 py-2 md:px-6 md:py-3 bg-red-500/80 hover:bg-red-600 text-white rounded-xl transition-all text-sm md:text-lg font-semibold"
                                        >
                                            ‚úï <span className="hidden md:inline">Ï¢ÖÎ£å</span>
                                        </button>
                                    </div>
                                </div>
                                <div className="h-2 md:h-3 bg-white/20 rounded-full overflow-hidden">
                                    <div 
                                        className="h-full bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 rounded-full transition-all duration-500"
                                        style={{ width: `${((currentSlide + 1) / totalSlides) * 100}%` }}
                                    ></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // File Upload Component
        const FileUploadZone = ({ label, file, onFileSelect, accept = ".xlsx,.xls" }) => {
            const inputRef = useRef(null);
            
            const handleDrop = (e) => {
                e.preventDefault();
                const droppedFile = e.dataTransfer.files[0];
                if (droppedFile) onFileSelect(droppedFile);
            };
            
            return (
                <div 
                    className={`file-upload-zone ${file ? 'has-file' : ''}`}
                    onClick={() => inputRef.current?.click()}
                    onDrop={handleDrop}
                    onDragOver={(e) => e.preventDefault()}
                >
                    <input 
                        ref={inputRef}
                        type="file" 
                        accept={accept}
                        className="hidden"
                        onChange={(e) => {
                            if (e.target.files[0]) onFileSelect(e.target.files[0]);
                        }}
                    />
                    <div className="text-center">
                        {file ? (
                            <>
                                <span className="text-3xl">‚úÖ</span>
                                <p className="mt-2 text-sm font-semibold text-green-700">{file.name}</p>
                            </>
                        ) : (
                            <>
                                <span className="text-3xl">üìÅ</span>
                                <p className="mt-2 text-sm font-medium text-gray-600">{label}</p>
                                <p className="text-xs text-gray-400">ÌÅ¥Î¶≠ÌïòÍ±∞ÎÇò ÌååÏùºÏùÑ ÎìúÎûòÍ∑∏ÌïòÏÑ∏Ïöî</p>
                            </>
                        )}
                    </div>
                </div>
            );
        };

        // Data Editor Modal (Enhanced)
        const DataEditorModal = ({ initialData, onSave, onClose }) => {
            const [data, setData] = useState(JSON.parse(JSON.stringify(getDefaultData())));
            const [activeTab, setActiveTab] = useState('basic');
            const [files, setFiles] = useState({
                teacher: null,
                student: null,
                parent: null,
                staff: null,
                trend: null
            });
            const [isProcessing, setIsProcessing] = useState(false);
            const [processStatus, setProcessStatus] = useState('');
            
            const updateField = (path, value) => {
                setData(prev => {
                    const newData = JSON.parse(JSON.stringify(prev));
                    const keys = path.split('.');
                    let current = newData;
                    for (let i = 0; i < keys.length - 1; i++) {
                        current = current[keys[i]];
                    }
                    current[keys[keys.length - 1]] = value;
                    return newData;
                });
            };
            
            const handleFileSelect = (type, file) => {
                setFiles(prev => ({ ...prev, [type]: file }));
            };
            
            const processFiles = async () => {
                // (Í∏∞Ï°¥Í≥º ÎèôÏùºÌïú Î°úÏßÅ Ïú†ÏßÄ)
                setIsProcessing(true);
                setProcessStatus('ÌååÏùº Î∂ÑÏÑù Ï§ë...');
                
                try {
                    const newData = JSON.parse(JSON.stringify(data));
                    let teacherData = { respondentCount: 0, averageScore: 0, highestScore: 0, lowestScore: 0, topItems: [], bottomItems: [] };
                    let studentData = { respondentCount: 0, averageScore: 0, highestScore: 0, lowestScore: 0, topItems: [], bottomItems: [] };
                    let parentData = { respondentCount: 0, averageScore: 0, highestScore: 0, lowestScore: 0, topItems: [], bottomItems: [] };
                    let staffData = { respondentCount: 0, averageScore: 0, highestScore: 0, lowestScore: 0, topItems: [], bottomItems: [] };
                    
                    if (files.teacher) {
                        setProcessStatus('ÍµêÏõê Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù Ï§ë...');
                        const rawData = await parseExcelFile(files.teacher);
                        teacherData = parseRespondentFile(rawData, 'teacher');
                        newData.respondentData[0].value = teacherData.respondentCount;
                        newData.respondentData[0].avg = teacherData.averageScore;
                        newData.comparisonData.teacher = {
                            average: teacherData.averageScore,
                            highest: teacherData.highestScore,
                            lowest: teacherData.lowestScore
                        };
                        newData.topBottomItems.teacherTop = teacherData.topItems;
                        newData.topBottomItems.teacherBottom = teacherData.bottomItems;
                    }
                    
                    if (files.student) {
                        setProcessStatus('ÌïôÏÉù Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù Ï§ë...');
                        const rawData = await parseExcelFile(files.student);
                        studentData = parseRespondentFile(rawData, 'student');
                        newData.respondentData[1].value = studentData.respondentCount;
                        newData.respondentData[1].avg = studentData.averageScore;
                        newData.comparisonData.student = {
                            average: studentData.averageScore,
                            highest: studentData.highestScore,
                            lowest: studentData.lowestScore
                        };
                        newData.topBottomItems.studentTop = studentData.topItems;
                        newData.topBottomItems.studentBottom = studentData.bottomItems;
                    }
                    
                    if (files.parent) {
                        setProcessStatus('ÌïôÎ∂ÄÎ™® Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù Ï§ë...');
                        const rawData = await parseExcelFile(files.parent);
                        parentData = parseRespondentFile(rawData, 'parent');
                        newData.respondentData[2].value = parentData.respondentCount;
                        newData.respondentData[2].avg = parentData.averageScore;
                        newData.comparisonData.parent = {
                            average: parentData.averageScore,
                            highest: parentData.highestScore,
                            lowest: parentData.lowestScore
                        };
                    }
                    
                    if (files.staff) {
                        setProcessStatus('ÏßÅÏõê Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù Ï§ë...');
                        const rawData = await parseExcelFile(files.staff);
                        staffData = parseRespondentFile(rawData, 'staff');
                        newData.respondentData[3].value = staffData.respondentCount;
                        newData.respondentData[3].avg = staffData.averageScore;
                        newData.comparisonData.staff = {
                            average: staffData.averageScore,
                            highest: staffData.highestScore,
                            lowest: staffData.lowestScore
                        };
                    }
                    
                    if (files.trend) {
                        setProcessStatus('Ïó∞ÎèÑÎ≥Ñ Ï∂îÏù¥ Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù Ï§ë...');
                        const rawData = await parseExcelFile(files.trend);
                        const trendResult = parseTrendFile(rawData);
                        if (trendResult.length > 0) {
                            newData.trendData = trendResult;
                        }
                    }
                    
                    const totalParticipants = newData.respondentData.reduce((sum, r) => sum + r.value, 0);
                    
                    let overallAvg = 0;
                    const validAvgs = newData.respondentData.filter(r => r.avg > 0).map(r => r.avg);
                    
                    if (validAvgs.length > 0) {
                        overallAvg = parseFloat((validAvgs.reduce((a, b) => a + b, 0) / validAvgs.length).toFixed(2));
                    }
                    
                    newData.kpiData[0].value = overallAvg;
                    newData.kpiData[1].value = totalParticipants;
                    
                    if (newData.trendData.length >= 2) {
                        const lastYear = newData.trendData[newData.trendData.length - 1];
                        const prevYear = newData.trendData[newData.trendData.length - 2];
                        
                        const currentYearStr = newData.academicYear;
                        const lastTrendIdx = newData.trendData.findIndex(t => t.year === currentYearStr);
                        if (lastTrendIdx >= 0) {
                            if (teacherData.averageScore > 0) newData.trendData[lastTrendIdx].teacher = teacherData.averageScore;
                            if (studentData.averageScore > 0) newData.trendData[lastTrendIdx].student = studentData.averageScore;
                            if (parentData.averageScore > 0) newData.trendData[lastTrendIdx].parent = parentData.averageScore;
                            if (staffData.averageScore > 0) newData.trendData[lastTrendIdx].staff = staffData.averageScore;
                            newData.trendData[lastTrendIdx].overall = overallAvg;
                        }
                        
                        const prevYearData = newData.trendData[newData.trendData.length - 2];
                        const change = parseFloat((overallAvg - prevYearData.overall).toFixed(2));
                        
                        newData.kpiData[0].change = change;
                        newData.kpiData[0].changeType = change >= 0 ? 'increase' : 'decrease';
                        newData.kpiData[2].value = change;
                        newData.kpiData[2].change = change;
                        newData.kpiData[2].changeType = change >= 0 ? 'increase' : 'decrease';
                        
                        newData.kpiData[1].change = 0; 
                    }
                    
                    newData.aiInsights = generateAIInsights(teacherData, studentData, parentData, staffData);
                    newData.actionItems = generateActionItems(teacherData, studentData);
                    
                    newData.voices = [];
                    if (teacherData.topItems.length > 0) {
                        newData.voices.push({
                            emoji: 'üòä',
                            text: teacherData.topItems[0].title,
                            source: 'ÍµêÏõê'
                        });
                    }
                    if (studentData.bottomItems.length > 0) {
                        newData.voices.push({
                            emoji: 'üòü',
                            text: studentData.bottomItems[0].title + ' Í∞úÏÑ† ÌïÑÏöî',
                            source: 'ÌïôÏÉù'
                        });
                    }
                    if (parentData.topItems && parentData.topItems.length > 0) {
                        newData.voices.push({
                            emoji: 'üí°',
                            text: parentData.topItems[0].title,
                            source: 'ÌïôÎ∂ÄÎ™®'
                        });
                    }
                    
                    setProcessStatus('Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ï§ë...');
                    setData(newData);
                    setProcessStatus('‚úÖ ÏôÑÎ£å! ' + totalParticipants + 'Î™ÖÏùò Îç∞Ïù¥ÌÑ∞Í∞Ä Î∂ÑÏÑùÎêòÏóàÏäµÎãàÎã§.');
                    
                    setTimeout(() => {
                        setIsProcessing(false);
                    }, 2000);
                    
                } catch (error) {
                    console.error('Error processing files:', error);
                    setProcessStatus('‚ùå Ïò§Î•ò Î∞úÏÉù: ' + error.message);
                    setTimeout(() => {
                        setIsProcessing(false);
                        setProcessStatus('');
                    }, 3000);
                }
            };
            
            const handleSave = () => {
                onSave(data);
                onClose();
            };
            
            const handleReset = () => {
                if (confirm('Î™®Îì† Îç∞Ïù¥ÌÑ∞Î•º Ï¥àÍ∏∞ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    localStorage.removeItem(STORAGE_KEY);
                    setData(getDefaultData());
                    setFiles({
                        teacher: null,
                        student: null,
                        parent: null,
                        staff: null,
                        trend: null
                    });
                }
            };

            return (
                <div className="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                    <div className="bg-white rounded-3xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col">
                        <div className="p-4 md:p-6 border-b border-gray-200 flex justify-between items-center">
                            <h2 className="text-xl md:text-2xl font-bold text-gray-900">üìù Îç∞Ïù¥ÌÑ∞ ÏÑ§Ï†ï</h2>
                            <button 
                                onClick={onClose}
                                className="p-2 hover:bg-gray-100 rounded-xl transition-all text-2xl"
                            >
                                ‚úï
                            </button>
                        </div>
                        
                        {/* Tabs */}
                        <div className="flex border-b border-gray-200 px-4 md:px-6">
                            <button 
                                className={`px-4 py-2 md:px-6 md:py-3 font-semibold transition-all text-sm md:text-base ${activeTab === 'basic' ? 'text-indigo-600 border-b-2 border-indigo-600' : 'text-gray-500'}`}
                                onClick={() => setActiveTab('basic')}
                            >
                                Í∏∞Î≥∏ Ï†ïÎ≥¥
                            </button>
                            
                            <button 
                                className={`px-4 py-2 md:px-6 md:py-3 font-semibold transition-all text-sm md:text-base ${activeTab === 'settings' ? 'text-indigo-600 border-b-2 border-indigo-600' : 'text-gray-500'}`}
                                onClick={() => setActiveTab('settings')}
                            >
                                Î™©Ìëú ÏÑ§Ï†ï
                            </button>
                        </div>

                        <div className="flex-1 overflow-y-auto p-4 md:p-6">
                            {activeTab === 'basic' && (
                                <div className="space-y-4 md:space-y-6 max-w-2xl mx-auto">
                                    <div className="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 md:p-6 rounded-2xl">
                                        <h3 className="text-lg md:text-xl font-bold text-gray-900 mb-4">üìö ÌïôÍµê Ï†ïÎ≥¥</h3>
                                        <div className="space-y-4">
                                            <div>
                                                <label className="form-label">ÌïôÍµê Ïù¥Î¶Ñ</label>
                                                <input
                                                    type="text"
                                                    value={data.schoolName}
                                                    onChange={(e) => updateField('schoolName', e.target.value)}
                                                    className="form-input"
                                                    placeholder="Ïòà: ÏõêÎ¨µÍ≥†Îì±ÌïôÍµê"
                                                />
                                            </div>
                                            <div className="grid grid-cols-2 gap-4">
                                                <div>
                                                    <label className="form-label">ÌïôÎÖÑÎèÑ</label>
                                                    <input
                                                        type="text"
                                                        value={data.academicYear}
                                                        onChange={(e) => updateField('academicYear', e.target.value)}
                                                        className="form-input"
                                                        placeholder="Ïòà: 2025"
                                                    />
                                                </div>
                                                <div>
                                                    <label className="form-label">ÌïôÍ∏∞</label>
                                                    <select
                                                        value={data.semester}
                                                        onChange={(e) => updateField('semester', e.target.value)}
                                                        className="form-input"
                                                    >
                                                        <option value="1ÌïôÍ∏∞">1ÌïôÍ∏∞</option>
                                                        <option value="2ÌïôÍ∏∞">2ÌïôÍ∏∞</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div className="bg-gradient-to-r from-green-50 to-emerald-50 p-4 md:p-6 rounded-2xl">
                                        <h3 className="text-lg md:text-xl font-bold text-gray-900 mb-4">üìä Í∑∏Î£πÎ≥Ñ Ïã§Ï†ú ÏùëÎãµÎ•† ÏÑ§Ï†ï</h3>
                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <label className="form-label">ÍµêÏÇ¨ ÏùëÎãµÎ•† (%)</label>
                                                <input
                                                    type="number"
                                                    value={data.responseRates.teacher}
                                                    onChange={(e) => updateField('responseRates.teacher', parseFloat(e.target.value))}
                                                    className="form-input"
                                                    min="0"
                                                    max="100"
                                                />
                                            </div>
                                            <div>
                                                <label className="form-label">ÌïôÏÉù ÏùëÎãµÎ•† (%)</label>
                                                <input
                                                    type="number"
                                                    value={data.responseRates.student}
                                                    onChange={(e) => updateField('responseRates.student', parseFloat(e.target.value))}
                                                    className="form-input"
                                                    min="0"
                                                    max="100"
                                                />
                                            </div>
                                            <div>
                                                <label className="form-label">ÌïôÎ∂ÄÎ™® ÏùëÎãµÎ•† (%)</label>
                                                <input
                                                    type="number"
                                                    value={data.responseRates.parent}
                                                    onChange={(e) => updateField('responseRates.parent', parseFloat(e.target.value))}
                                                    className="form-input"
                                                    min="0"
                                                    max="100"
                                                />
                                            </div>
                                            <div>
                                                <label className="form-label">ÏßÅÏõê ÏùëÎãµÎ•† (%)</label>
                                                <input
                                                    type="number"
                                                    value={data.responseRates.staff}
                                                    onChange={(e) => updateField('responseRates.staff', parseFloat(e.target.value))}
                                                    className="form-input"
                                                    min="0"
                                                    max="100"
                                                />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}
                            
                            {activeTab === 'settings' && (
                                <div className="space-y-4 md:space-y-6 max-w-2xl mx-auto">
                                    <div className="bg-gradient-to-r from-amber-50 to-orange-50 p-4 md:p-6 rounded-2xl">
                                        <h3 className="text-lg md:text-xl font-bold text-gray-900 mb-4">üéØ ÎßåÏ°±ÎèÑ Î™©Ìëú</h3>
                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <label className="form-label">ÌòÑÏû¨ Ï†êÏàò</label>
                                                <input
                                                    type="number"
                                                    value={data.goal.currentScore}
                                                    onChange={(e) => updateField('goal.currentScore', parseFloat(e.target.value))}
                                                    className="form-input"
                                                    step="0.01"
                                                    min="0"
                                                    max="5"
                                                />
                                            </div>
                                            <div>
                                                <label className="form-label">Î™©Ìëú Ï†êÏàò</label>
                                                <input
                                                    type="number"
                                                    value={data.goal.targetScore}
                                                    onChange={(e) => updateField('goal.targetScore', parseFloat(e.target.value))}
                                                    className="form-input"
                                                    step="0.01"
                                                    min="0"
                                                    max="5"
                                                />
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div className="bg-red-50 border border-red-200 p-4 rounded-xl">
                                        <h4 className="font-bold text-red-800 mb-2">‚ö†Ô∏è Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî</h4>
                                        <p className="text-sm text-red-700 mb-4">Î™®Îì† Îç∞Ïù¥ÌÑ∞Î•º ÏÇ≠Ï†úÌïòÍ≥† Ï¥àÍ∏∞ ÏÉÅÌÉúÎ°ú ÎêòÎèåÎ¶ΩÎãàÎã§.</p>
                                        <button 
                                            onClick={handleReset}
                                            className="px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-xl font-semibold transition-all w-full md:w-auto"
                                        >
                                            üóëÔ∏è Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>

                        <div className="p-4 md:p-6 border-t border-gray-200 flex justify-end gap-3 bg-gray-50 rounded-b-3xl">
                            <button 
                                onClick={onClose}
                                className="px-6 py-2 md:px-8 md:py-3 rounded-xl bg-gray-200 hover:bg-gray-300 font-bold text-gray-700 transition-all text-sm md:text-base"
                            >
                                Ï∑®ÏÜå
                            </button>
                            <button 
                                onClick={handleSave}
                                className="px-6 py-2 md:px-8 md:py-3 rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white font-bold shadow-lg transition-all text-sm md:text-base"
                            >
                                üíæ Ï†ÄÏû•ÌïòÍ∏∞
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // App Component
        const App = () => {
            const [appState, setAppState] = useState('splash');
            const [isEditorOpen, setEditorOpen] = useState(false);
            const [schoolData, setSchoolData] = useState(() => {
                return getDefaultData();
            });
            const [presentationStartSlide, setPresentationStartSlide] = useState(0);

            const handleFinishSplash = useCallback(() => setAppState('dashboard'), []);
            
            const handleEnterPresentation = useCallback((startSlide = 0) => {
                setPresentationStartSlide(startSlide);
                setAppState('presentation');
            }, []);
            
            const handleExitPresentation = useCallback(() => { 
                if (document.fullscreenElement) document.exitFullscreen();
                setAppState('dashboard'); 
            }, []);
            
            const handleSaveData = useCallback((newData) => {
                setSchoolData(newData);
            }, []);

            const renderContent = () => {
                switch (appState) {
                    case 'splash': 
                        return <PremiumSplashScreen onFinished={handleFinishSplash} schoolData={schoolData} />;
                    case 'dashboard': 
                        return <PremiumDashboard 
                            schoolData={schoolData} 
                            onEnterPresentation={handleEnterPresentation}
                            onOpenDataEditor={() => setEditorOpen(true)} 
                        />;
                    case 'presentation': 
                        return <PremiumPresentationMode 
                            schoolData={schoolData} 
                            onExit={handleExitPresentation}
                            startSlide={presentationStartSlide} 
                        />;
                    default: 
                        return null;
                }
            };

            return (
                <>
                    {renderContent()}
                    {isEditorOpen && ( 
                        <DataEditorModal 
                            initialData={schoolData} 
                            onSave={handleSaveData}
                            onClose={() => setEditorOpen(false)} 
                        /> 
                    )}
                </>
            );
        };

        const rootElement = document.getElementById('root');
        const root = createRoot(rootElement);
        root.render(<App />);
    </script>
</body>
</html>
